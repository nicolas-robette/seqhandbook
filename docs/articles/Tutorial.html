<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>[eng] Tutorial on sequence analysis • seqhandbook</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="[eng] Tutorial on sequence analysis">
<meta property="og:description" content="seqhandbook">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">seqhandbook</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Tutorial.html">[eng] Tutorial on sequence analysis</a>
    </li>
    <li>
      <a href="../articles/Tutoriel.html">[fr] Tutoriel d'analyse de séquences</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>[eng] Tutorial on sequence analysis</h1>
                        <h4 data-toc-skip class="author">Nicolas
Robette</h4>
            
            <h4 data-toc-skip class="date">2023-04-02</h4>
      
      
      <div class="hidden name"><code>Tutorial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="preliminary-steps">Preliminary steps<a class="anchor" aria-label="anchor" href="#preliminary-steps"></a>
</h2>
<p>Start by loading the necessary packages (which must be installed
beforehand if they are not already installed) : <code class="pkg">TraMineR</code> and <code class="pkg">TraMineRextras</code>
for sequence analysis, <code class="pkg">cluster</code> and <code class="pkg">WeightedCluster</code> for clustering, <code class="pkg">FactoMineR</code> et <code class="pkg">ade4</code> for
correspondence analysis, <code class="pkg">RColorBrewer</code> for color
palettes, <code class="pkg">questionr</code> et <code class="pkg">descriptio</code> for descriptive statistics, <code class="pkg">dplyr</code> et <code class="pkg">purrr</code> for data
manipulation, <code class="pkg">ggplot2</code> for plots and <code class="pkg">seqhandbook</code> which accompanies the handbook.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://traminer.unige.ch" class="external-link">TraMineR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://traminer.unige.ch/" class="external-link">TraMineRextras</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/" class="external-link">cluster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mephisto.unige.ch/weightedcluster/" class="external-link">WeightedCluster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr" class="external-link">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://juba.github.io/questionr/" class="external-link">questionr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nicolas-robette/descriptio" class="external-link">descriptio</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nicolas-robette.github.io/seqhandbook/">seqhandbook</a></span><span class="op">)</span></span></code></pre></div>
<p>The data used in the handbook is then loaded. The data on employment
trajectories are in the data frame <code>trajact</code>: there are 500
observations, i.e. 500 individual trajectories, and 37 variables,
corresponding to the activity status observed each year between the ages
of 14 and 50.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># loading the trajectories</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">trajact</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajact</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  37 variables:
 $ sact14: num  2 1 1 1 1 1 1 1 1 1 ...
 $ sact15: num  2 1 1 1 1 1 1 1 1 1 ...
 $ sact16: num  2 1 1 1 1 1 1 1 1 1 ...
 $ sact17: num  2 1 1 1 1 1 2 2 2 2 ...
 $ sact18: num  2 1 2 2 1 1 2 2 2 2 ...
 $ sact19: num  2 3 2 2 1 1 2 2 2 2 ...
 $ sact20: num  2 3 2 6 2 2 5 2 6 2 ...
 $ sact21: num  2 3 2 2 2 2 5 6 6 2 ...
 $ sact22: num  2 3 2 2 2 2 5 6 2 2 ...
 $ sact23: num  2 3 2 2 2 2 5 2 2 2 ...
 $ sact24: num  2 3 2 2 2 5 3 2 2 2 ...
 $ sact25: num  2 3 2 2 2 5 3 2 2 2 ...
 $ sact26: num  2 3 2 2 2 5 3 2 2 2 ...
 $ sact27: num  2 3 2 2 2 2 3 2 2 2 ...
 $ sact28: num  2 3 5 2 2 2 3 2 2 2 ...
 $ sact29: num  2 3 2 2 2 2 3 2 2 2 ...
 $ sact30: num  2 3 5 2 2 2 3 2 2 2 ...
 $ sact31: num  2 3 5 2 2 2 3 2 2 2 ...
 $ sact32: num  2 3 5 2 2 2 5 2 2 2 ...
 $ sact33: num  2 3 5 2 2 2 5 2 2 2 ...
 $ sact34: num  2 3 5 2 2 2 5 2 2 2 ...
 $ sact35: num  2 3 5 2 2 2 2 2 2 2 ...
 $ sact36: num  2 3 5 2 2 2 2 2 2 2 ...
 $ sact37: num  2 3 5 2 2 2 2 2 2 2 ...
 $ sact38: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact39: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact40: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact41: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact42: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact43: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact44: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact45: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact46: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact47: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact48: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact49: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact50: num  2 3 3 2 2 2 2 2 2 2 ...</code></pre>
<p>The first step in sequence analysis is to create a corpus of
sequences, i.e. a <code>stslist</code> class object using the
<code>seqdef</code> function. First the labels of the 6 states and a
palette of 6 colours are defined (this is optional: <code>seqdef</code>
creates labels and palette automatically if not provided).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># defining of a corpus of sequences</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"studies"</span>,<span class="st">"full-time"</span>,<span class="st">"part-time"</span>,<span class="st">"short jobs"</span>,<span class="st">"inactivity"</span>,<span class="st">"military"</span><span class="op">)</span></span>
<span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">labs</span><span class="op">)</span>, <span class="st">'Set2'</span><span class="op">)</span></span>
<span><span class="va">seqact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajact</span>, labels<span class="op">=</span><span class="va">labs</span>, cpal<span class="op">=</span><span class="va">palette</span><span class="op">)</span></span></code></pre></div>
<p>Our corpus of 500 sequences consists of 377 distinct sequences, which
confirms the interest of using a statistical procedure to group together
sequences that are similar.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># number of distinct sequences</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtab.html" class="external-link">seqtab</a></span><span class="op">(</span><span class="va">seqact</span>, idx<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">nrow</span></span></code></pre></div>
<pre><code>[1] 377</code></pre>
<p>The <em>state distribution plot</em> of all the sequences shows the
preponderance of full-time employment and the non-negligible weight of
inactivity.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># state distribution plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqact</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, cex.legend<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/fig1-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>A data frame is also loaded containing some socio-demographic
variables on the individuals. Note that the categorical variables are in
<code>factor</code> format.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># loading the socio-demographic variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  9 variables:
 $ annais     : num  1950 1937 1933 1948 1944 ...
 $ nbenf      : Factor w/ 4 levels "aucun","un","deux",..: 4 3 3 3 3 2 4 4 4 1 ...
 $ nbunion    : Factor w/ 3 levels "aucune","une",..: 2 2 2 2 3 2 2 2 2 1 ...
 $ mereactive : Factor w/ 2 levels "non","oui": 1 1 2 2 1 1 2 1 1 2 ...
 $ sexe       : Factor w/ 2 levels "homme","femme": 1 2 2 1 2 2 2 1 1 2 ...
 $ PCS        : Factor w/ 8 levels "NA","agric","indep",..: 7 8 5 7 6 5 6 7 7 4 ...
 $ PCSpere    : Factor w/ 8 levels "agric","indep",..: 7 1 5 2 6 3 6 5 6 6 ...
 $ diplome    : Factor w/ 4 levels "aucun","&lt;bac",..: 1 2 2 2 3 4 2 2 2 2 ...
 $ nationalite: Factor w/ 2 levels "francaise","etrangere": 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<hr>
</div>
<div class="section level2">
<h2 id="building-a-distance-matrix">Building a distance matrix<a class="anchor" aria-label="anchor" href="#building-a-distance-matrix"></a>
</h2>
<div class="section level3">
<h3 id="synthetic-indicators">Synthetic indicators<a class="anchor" aria-label="anchor" href="#synthetic-indicators"></a>
</h3>
<p>As an example, a distance matrix is constructed from indicators
describing the number of episodes in the different states. The first
individual has spent his entire trajectory in full-time employment,
while the second has experienced one full-time episode but also one
episode of study and two of part-time employment.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seqinepi.html">seqinepi</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">indics</span><span class="op">)</span></span></code></pre></div>
<pre><code>  nepi1 nepi2 nepi3 nepi4 nepi5 nepi6
1     0     1     0     0     0     0
2     1     1     2     0     0     0
3     1     2     1     0     2     0
4     1     2     0     0     0     1
5     1     1     0     0     0     0
6     1     2     0     0     1     0</code></pre>
<p>The matrix can be calculated directly from the indicators or after a
Principal Component Analysis (PCA) step, here by retaining the first 5
dimensions.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># distance matrix from the indicator</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">indics</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># distance matrix from PCA results</span></span>
<span><span class="va">acp_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html" class="external-link">PCA</a></span><span class="op">(</span><span class="va">indics</span>, scale.unit<span class="op">=</span><span class="cn">FALSE</span>, ncp<span class="op">=</span><span class="fl">5</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">acp_coords</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span></code></pre></div>
<p>Other synthetic indicators (durations, states visited, etc.) can be
calculated simply from the functions <code>seqistatd</code>,
<code>seqi1epi</code>, <code>seqifpos</code>, <code>seqindic</code> or
<code>seqpropclust</code>.</p>
</div>
<div class="section level3">
<h3 id="disjunctive-coding-and-qha">Disjunctive coding and QHA<a class="anchor" aria-label="anchor" href="#disjunctive-coding-and-qha"></a>
</h3>
<p>In the case of complete disjunctive coding, the distance matrix can
be calculated directly, with the Euclidean distance or the chi2
distance, or after a Principal Component Analysis (PCA) or Multiple
Correspondence Analysis (MCA) step, here by retaining the first 5
dimensions.</p>
<p>NB: <code>map_df</code> allows you to apply the same function to all
the columns of a data frame. Here, this function is used to convert
columns from numerical format to <code>factor</code> format.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># complete disjunctive coding</span></span>
<span><span class="va">disjo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/tab.disjonctif.html" class="external-link">tab.disjonctif</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">disjo</span> <span class="op">&lt;-</span> <span class="va">disjo</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">disjo</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># euclidian distance</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">disjo</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># chi2 distance</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">disjo</span>, <span class="va">as.factor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.acm.html" class="external-link">dudi.acm</a></span><span class="op">(</span>scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">disjo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dist.dudi.html" class="external-link">dist.dudi</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># after a PCA step</span></span>
<span><span class="va">acp_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html" class="external-link">PCA</a></span><span class="op">(</span><span class="va">disjo</span>, scale.unit<span class="op">=</span><span class="cn">FALSE</span>, ncp<span class="op">=</span><span class="fl">5</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">acp_coords</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># after a MCA step</span></span>
<span><span class="va">acm_res</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">disjo</span>, <span class="va">as.factor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/MCA.html" class="external-link">MCA</a></span><span class="op">(</span>ncp<span class="op">=</span><span class="fl">5</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">acm_res</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span></code></pre></div>
<p>For the qualitative harmonic analysis (QHA), the calculation of the
distance matrix can be done directly (chi2 distance) or after a
correspondence analysis (CA), here using the first 5 dimensions.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># QHA coding</span></span>
<span><span class="va">ahq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seq2qha.html">seq2qha</a></span><span class="op">(</span><span class="va">seqact</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">28</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ahq</span> <span class="op">&lt;-</span> <span class="va">ahq</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">ahq</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># chi2 distance</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.coa.html" class="external-link">dudi.coa</a></span><span class="op">(</span><span class="va">ahq</span>, scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ahq</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dist.dudi.html" class="external-link">dist.dudi</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># after a CA step</span></span>
<span><span class="va">afc_coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/CA.html" class="external-link">CA</a></span><span class="op">(</span><span class="va">ahq</span>, ncp<span class="op">=</span><span class="fl">5</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">row</span><span class="op">$</span><span class="va">coord</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">afc_coord</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optimal-matching-and-alternatives">
<em>Optimal Matching</em> and alternatives<a class="anchor" aria-label="anchor" href="#optimal-matching-and-alternatives"></a>
</h3>
<p>For <em>Optimal Matching</em>, the construction of a distance matrix
between sequences is done with the <code>seqdist</code> function. This
also involves defining a substitution cost matrix between states (with
the <code>seqsubm</code> function). Here the substitution costs are
constant and equal to 2 and the <em>indel</em> cost is equal to 1.5.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># building the distance matrix</span></span>
<span><span class="va">couts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"CONSTANT"</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"OM"</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p>From experience, <em>Optimal Matching</em> with the parameters
adopted here is a choice that allows the different dimensions of
sequence temporality to be taken into account - <em>sequencing</em>,
calendar (<em>timing</em>), duration (in different states or episodes,
<em>duration</em> and <em>spell duration</em>). If you wish to focus on
one of these dimensions, you can follow the recommendations of Studer
&amp; Ritschard (2016, see in particular pages 507-509), and choose one
of the many other metrics implemented in the <code>TraMineR</code>
extension.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sequencing</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"OMstran"</span>, otto<span class="op">=</span><span class="fl">0.1</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"OMspell"</span>, expcost<span class="op">=</span><span class="fl">0</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"SVRspell"</span>, tpow<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># timing</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"HAM"</span>, sm<span class="op">=</span><span class="va">couts</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"CHI2"</span>, step<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># duration (distribution aver the entire period)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"EUCLID"</span>, step<span class="op">=</span><span class="fl">37</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># duration (spell lengths)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"OMspell"</span>, expcost<span class="op">=</span><span class="fl">1</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"LCS"</span><span class="op">)</span></span></code></pre></div>
<p>Note that methods using the complete disjunctive coding or QHA are
also implemented in the <code>seqdist</code> function (“EUCLID” and
“CHI2” methods).</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="typology-of-sequences">Typology of sequences<a class="anchor" aria-label="anchor" href="#typology-of-sequences"></a>
</h2>
<div class="section level3">
<h3 id="building-a-typology">Building a typology<a class="anchor" aria-label="anchor" href="#building-a-typology"></a>
</h3>
<p>A hierarchical agglomerative clustering (HAC) is then carried out
using Ward’s aggregation criterion, using the <code>agnes</code>
function of the <code>cluster</code> extension.</p>
<p>NB: With a high number of sequences, HAC may require a significant
amount of computing time. However, there is a much faster implementation
in the <code>fastcluster</code> package (<code>hclust</code>
function).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># hierarchical agglomerative clustering</span></span>
<span><span class="va">agnes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"ward"</span>, keep.diss<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>In order to explore the solutions of a hierarchical agglomerative
clustering, one usually starts by examining the dendrogram.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># dendrogram</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">agnes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>leaflab<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The following graph combines dendrogram and <em>index plot</em>: the
sequences of the index plot index are sorted according to their position
in the dendrogram, which is shown in the margin of the graph.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># heatmap (dendrogram + index plot)</span></span>
<span><span class="fu"><a href="../reference/seq_heatmap.html">seq_heatmap</a></span><span class="op">(</span><span class="va">seqact</span>, <span class="va">agnes</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-14-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Examination of inertia gaps can also be useful in determining the
number of clusters in the typology. For example, it can be seen that
there is a noticeable difference in inertia between partitions in 5 and
6 clusters.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot of inertia</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">agnes</span><span class="op">$</span><span class="va">height</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"s"</span>, xlab<span class="op">=</span><span class="st">"number of clusters"</span>, ylab<span class="op">=</span><span class="st">"inertia"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-15-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>There are also a number of indicators of partition quality
(silhouette, Calinski-Harabasz, pseudo-R2, etc.; see Studer, 2013).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># indicators of quality</span></span>
<span><span class="va">wardRange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WeightedCluster/man/as.clustrange.html" class="external-link">as.clustrange</a></span><span class="op">(</span><span class="va">agnes</span>, diss<span class="op">=</span><span class="va">dissim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wardRange</span>, max.rank<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>     1. N groups     1.  stat 2. N groups     2.  stat
PBC            5   0.79612318           4   0.79012613
HG             5   0.92899997           4   0.92259604
HGSD           5   0.92672338           4   0.92027518
ASW            3   0.53491169           2   0.52958820
ASWw           3   0.53862662           2   0.53182999
CH             2 156.86409716           3 103.74539004
R2            20   0.60648740          19   0.59473652
CHsq           2 324.53910100           3 245.89231855
R2sq          20   0.82862437          19   0.82073439
HC             5   0.04010082           4   0.04392402</code></pre>
<p>The quality of the partitions for different numbers of clusters for
the silhouette, pseudo-R2 and Calinski-Harabasz indicators is shown
graphically here.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wardRange</span>, stat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ASW'</span>,<span class="st">'R2'</span>,<span class="st">'CH'</span><span class="op">)</span>, norm<span class="op">=</span><span class="st">"zscore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-17-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>In the end, we opt for a partition in 5 clusters, by “cutting the
tree” of the HAC using the <code>cutree</code> function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choosing the partition in 5 clusters</span></span>
<span><span class="va">nbcl</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">part</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">agnes</span>, <span class="va">nbcl</span><span class="op">)</span></span></code></pre></div>
<p>It is possible to “consolidate” the partition using the PAM algorithm
(<em>Partition Around Medoids</em>) and the <code>wcKMedoids</code>
function of the <code>WeightedCluster</code> package. This results in a
very similar distribution of sequences between the clusters (see the
table crossing the clusters before and after consolidation) but the
quality of the consolidated partition is slightly higher (the R² goes
from 61 to 64%).</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># consolidating the partition</span></span>
<span><span class="va">newpart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WeightedCluster/man/kmedoids.html" class="external-link">wcKMedoids</a></span><span class="op">(</span><span class="va">dissim</span>, k<span class="op">=</span><span class="va">nbcl</span>, initialclust<span class="op">=</span><span class="va">part</span>, cluster.only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">part</span>, <span class="va">newpart</span><span class="op">)</span></span></code></pre></div>
<pre><code>    newpart
part  28  34 103 307 480
   1 104 241   1   0   0
   2   9  24   2   7   0
   3   0   6   6  63   1
   4   0   0  17   0   0
   5   8   0   0   1  10</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/WeightedCluster/man/clusterquality.html" class="external-link">wcClusterQuality</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">part</span><span class="op">)</span><span class="op">$</span><span class="va">stats</span><span class="op">[</span><span class="st">'R2sq'</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span> <span class="va">R2sq</span> </span>
<span><span class="fl">0.607</span> </span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/WeightedCluster/man/clusterquality.html" class="external-link">wcClusterQuality</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">newpart</span><span class="op">)</span><span class="op">$</span><span class="va">stats</span><span class="op">[</span><span class="st">'R2sq'</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="va">R2sq</span> </span>
<span><span class="fl">0.64</span> </span></code></pre>
<p>If you wish to keep the consolidated partition :</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">part</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">newpart</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>NB: Another option, the “fuzzy” clustering, here with the Fanny
algorithm (extension <code>cluster</code>). Unlike HAC or PAM, each
sequence does not belong to a single cluster but is characterised by
degrees of membership to the different clusters. The following table
presents the degrees of membership to the 6 clusters of the first 3
sequences of the corpus. The first sequence belongs 99% to cluster 1,
but the second is more “balanced”, mainly between clusters 2 and 5.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fuzzy clustering</span></span>
<span><span class="va">fanny</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/fanny.html" class="external-link">fanny</a></span><span class="op">(</span>k<span class="op">=</span><span class="fl">5</span>, metric<span class="op">=</span><span class="st">'euclidean'</span>, memb.exp<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="va">fanny</span><span class="op">$</span><span class="va">membership</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">.</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre></div>
<pre><code>  [,1] [,2] [,3] [,4] [,5]
1 0.99 0.00 0.00 0.01 0.00
2 0.06 0.51 0.02 0.13 0.28
3 0.00 0.11 0.80 0.00 0.08</code></pre>
</div>
<div class="section level3">
<h3 id="describing-the-typology-plots">Describing the typology: plots<a class="anchor" aria-label="anchor" href="#describing-the-typology-plots"></a>
</h3>
<p>The graphical representations give a quick and intuitive idea of the
nature of the clusters in the typology. The most commonly used type of
graph is the <em>state distribution plot</em>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># state distribution plots of the typology</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, border<span class="op">=</span><span class="cn">NA</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-22-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The <em>index plots</em> are also very common.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># index plots of the typology</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-23-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The <em>index plots</em> are often easier to interpret when sorting
sequences, especially from a <em>multidimensional scaling</em>
procedure.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># index plots of the typology, sorted by multidimensional scaling</span></span>
<span><span class="va">mds.order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dissim</span>,k<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqact</span>, sortv<span class="op">=</span><span class="va">mds.order</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-24-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>They can also be “smoothed” to make them more legible.</p>
<p>“<em>smoothed MDS sequence plots</em>” method (Piccarreta, 2012):</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoothed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seqsmooth.html">seqsmooth</a></span><span class="op">(</span><span class="va">seqact</span>, <span class="va">dissim</span>, k<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">$</span><span class="va">seqdata</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">smoothed</span>, sortv<span class="op">=</span><span class="va">mds.order</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>“<em>relative frequency sequence plots</em>” method (Fasang &amp;
Liao, 2013):</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># relative frequency sequence plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineRextras/man/seqplot-rf.html" class="external-link">seqplot.rf</a></span><span class="op">(</span><span class="va">seqact</span>, diss<span class="op">=</span><span class="va">dissim</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, which.plot<span class="op">=</span><span class="st">"medoids"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-26-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The <em>sequence frequency plots</em> represent, for each cluster,
the 10 most frequent sequences (with a thickness proportional to their
frequency).</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># frequency plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqfplot</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">part</span>, ylab<span class="op">=</span><span class="st">""</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-27-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The <em>modal state sequence plots</em> represent, for each cluster,
the sequence of modal states for each position in time. At each position
in time, the height of the bar is proportional to the frequency of the
modal state.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># modal state plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqmsplot</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-28-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="describing-the-typology-descriptive-statistics">Describing the typology: descriptive statistics<a class="anchor" aria-label="anchor" href="#describing-the-typology-descriptive-statistics"></a>
</h3>
<p>The first step in the statistical description of the typology is
usually to present the weight of the clusters. Cluster 2 comprises more
than half of the individuals, while clusters 3 and 5 are very small.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># weights and percentages</span></span>
<span><span class="fu"><a href="https://juba.github.io/questionr/reference/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span></span></code></pre></div>
<pre><code>    n    % val%
1 121 24.2 24.2
2 271 54.2 54.2
3  26  5.2  5.2
4  71 14.2 14.2
5  11  2.2  2.2</code></pre>
<p>It is useful to assess the homogeneity of clusters. This can be done
on the basis of intra-cluster distances. Clusters 1 and 2 are the most
homogeneous.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># intra-cluster distances</span></span>
<span><span class="va">Dintra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span>length<span class="op">=</span><span class="va">nbcl</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl</span><span class="op">)</span> <span class="va">Dintra</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">[</span><span class="va">part</span><span class="op">==</span><span class="va">i</span>,<span class="va">part</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Dintra</span></span></code></pre></div>
<pre><code>[1] 18.3 15.2 30.2 28.4 24.3</code></pre>
<p>The results are convergent based on average distances to cluster
centres:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># average distances to cluster centres</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/dissassoc.html" class="external-link">dissassoc</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">part</span><span class="op">)</span><span class="op">$</span><span class="va">groups</span></span></code></pre></div>
<pre><code>        n discrepancy
1     121    9.171231
2     271    7.617135
3      26   15.078402
4      71   14.208490
5      11   12.173554
Total 500   15.876208</code></pre>
<p>The same applies to transversal entropy:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># average transversal entropy per cluster</span></span>
<span><span class="va">entropie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl</span><span class="op">)</span> <span class="va">entropie</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">seqstatd</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">[</span><span class="va">part</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">Entropy</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">entropie</span></span></code></pre></div>
<pre><code>[1] 0.33 0.27 0.47 0.46 0.36</code></pre>
<p>To give a more detailed view of the shape of the trajectories of each
cluster, synthetic indicators are calculated and then averaged according
to the cluster of the typology. The time spent in the states :</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># time spent in the states per cluster</span></span>
<span><span class="va">dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqistatd.html" class="external-link">seqistatd</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span></span>
<span><span class="va">durees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">dur</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">durees</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">durees</span></span></code></pre></div>
<pre><code>  Group.1    1    2    3    4    5   6
1       1 10.2 23.1  0.7  0.7  1.3 1.0
2       2  3.5 29.9  0.4  0.9  1.7 0.6
3       3  6.3  9.2 16.4  1.0  4.0 0.0
4       4  5.0  7.1  1.2  1.6 22.0 0.1
5       5  7.0  3.6  0.6 22.8  2.7 0.2</code></pre>
<p>The share of individuals having experienced at least one episode in
the states :</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># at least one episode in the states, per cluster</span></span>
<span><span class="va">epi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seqi1epi.html">seqi1epi</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span></span>
<span><span class="va">episodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">epi</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">episodes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">episodes</span></span></code></pre></div>
<pre><code>  Group.1 epi1 epi2 epi3 epi4 epi5 epi6
1       1 1.00 0.99 0.16 0.14 0.32 0.36
2       2 0.86 1.00 0.06 0.17 0.31 0.35
3       3 0.92 0.73 1.00 0.15 0.62 0.04
4       4 0.86 0.75 0.24 0.24 1.00 0.03
5       5 0.91 0.82 0.27 1.00 0.36 0.09</code></pre>
<p>Ensuite, on croise la typologie avec les caractéristiques des
individus. On commence par une analyse bivariée du type de trajectoire
selon le sexe. Le V² de Cramer est de 0,16, indiquant une association
notable. Les femmes sont très sur-représentées dans la classe 4 et
secondairement dans la classe 3, alors que les hommes sont
sur-représentés dans les classes 1 et 2 (les valeurs “phi” correspondent
aux attractions ou répulsions entre modalités).</p>
<p>Next, the typology is cross-tabulated with the characteristics of the
individuals. We begin with a bivariate analysis of the type of
trajectory according to gender. Cramer’s V² is 0.40, indicating a
significant association. Women are highly over-represented in cluster 4
and secondarily in cluster 3, while men are over-represented in clusters
1 and 2 (the “phi” values correspond to attractions or repulsions
between categories).</p>
<p>NB: The two objects <code>part</code> and <code>socdem</code> must
not have been sorted. If this is nevertheless the case, they must be
merged from a common identifier, or re-sorted according to the initial
order.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nicolas-robette.github.io/descriptio/reference/assoc.twocat.html" class="external-link">assoc.twocat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span>, <span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span></span>
<span><span class="va">asso</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">cramer.v</span></span></code></pre></div>
<pre><code>[1] 0.401948</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asso</span><span class="op">$</span><span class="va">local</span><span class="op">$</span><span class="va">phi</span></span></code></pre></div>
<pre><code>        homme       femme
1  0.16239591 -0.16239591
2  0.18154113 -0.18154113
3 -0.17650554  0.17650554
4 -0.33493171  0.33493171
5 -0.02662907  0.02662907</code></pre>
<p>The over-representations for each cluster in the typology are then
examined on the basis of all the individual characteristics present in
the <code>socdem</code> data frame. First of all, it can be seen that
only three variables do not seem to be significantly related to the type
of trajectory (mereactive, nbunion, nationality). To take just the
example of cluster 4, we see that women are over-represented there, as
well as individuals with three or more children, without a diploma or
with unknown PCS (which is certainly not unrelated to inactivity).</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://nicolas-robette.github.io/descriptio/reference/catdesc.html" class="external-link">catdesc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span>, <span class="va">socdem</span>, limit <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code>$variables
     variable  measure association
1        sexe Cramer V       0.402
2         PCS Cramer V       0.362
3     diplome Cramer V       0.330
4     PCSpere Cramer V       0.202
5       nbenf Cramer V       0.146
6  mereactive Cramer V       0.130
7     nbunion Cramer V       0.094
8 nationalite Cramer V       0.057
9      annais     Eta2       0.041

$bylevel
$bylevel$`1`
$bylevel$`1`$categories
       categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
1    diplome.&gt;bac            0.598            0.628           0.254  0.486
3        PCS.pcis            0.579            0.512           0.214  0.411
7    PCSpere.pcis            0.519            0.331           0.154  0.276
12     sexe.homme            0.319            0.595           0.452  0.162
16    nbenf.aucun            0.367            0.182           0.120  0.107
19    diplome.bac            0.342            0.223           0.158  0.101
21      PCS.oqual            0.098            0.033           0.082 -0.101
22  PCSpere.agric            0.106            0.041           0.094 -0.102
25         PCS.NA            0.111            0.066           0.144 -0.125
27 PCSpere.onqual            0.058            0.025           0.104 -0.147
28  diplome.aucun            0.075            0.041           0.134 -0.154
29     sexe.femme            0.179            0.405           0.548 -0.162
31       PCS.empl            0.107            0.107           0.242 -0.178
39   diplome.&lt;bac            0.057            0.107           0.454 -0.393

$bylevel$`1`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global  cor
3    annais             1945            1943             4            5 0.08


$bylevel$`2`
$bylevel$`2`$categories
       categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
5    diplome.&lt;bac            0.722            0.605           0.454  0.330
8       PCS.oqual            0.878            0.133           0.082  0.202
10     sexe.homme            0.642            0.535           0.452  0.182
13       PCS.empl            0.678            0.303           0.242  0.154
14  PCSpere.oqual            0.670            0.262           0.212  0.133
18 PCSpere.onqual            0.692            0.133           0.104  0.103
32     sexe.femme            0.460            0.465           0.548 -0.182
33         PCS.NA            0.306            0.081           0.144 -0.195
35       PCS.pcis            0.308            0.122           0.214 -0.245
36   PCSpere.pcis            0.195            0.055           0.154 -0.297
38   diplome.&gt;bac            0.228            0.107           0.254 -0.367

$bylevel$`2`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global    cor
5    annais             1942            1943             5            5 -0.102


$bylevel$`3`
$bylevel$`3`$categories
   categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
11 sexe.femme            0.088            0.923           0.548  0.177
30 sexe.homme            0.009            0.077           0.452 -0.177

$bylevel$`3`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global   cor
1    annais             1947            1943             2            5 0.139


$bylevel$`4`
$bylevel$`4`$categories
         categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
2            PCS.NA            0.542            0.549           0.144  0.470
4        sexe.femme            0.248            0.958           0.548  0.335
9  nbenf.trois ou +            0.235            0.535           0.324  0.184
15    diplome.aucun            0.239            0.225           0.134  0.109
17   mereactive.non            0.173            0.704           0.578  0.104
20        PCS.oqual            0.024            0.014           0.082 -0.101
23   mereactive.oui            0.100            0.296           0.422 -0.104
24     diplome.&gt;bac            0.079            0.141           0.254 -0.106
26         PCS.pint            0.065            0.113           0.248 -0.127
34         PCS.pcis            0.009            0.014           0.214 -0.198
37       sexe.homme            0.013            0.042           0.452 -0.335

$bylevel$`4`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global    cor
4    annais             1942            1943             5            5 -0.079


$bylevel$`5`
$bylevel$`5`$categories
  categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global   phi
6  PCS.agric                1            0.091           0.002 0.298

$bylevel$`5`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global   cor
2    annais             1948            1943             0            5 0.087</code></pre>
</div>
<div class="section level3">
<h3 id="describing-the-typology-medoids">Describing the typology: medoids<a class="anchor" aria-label="anchor" href="#describing-the-typology-medoids"></a>
</h3>
<p>To “flesh out” the typology, we sometimes resort to the
<em>medoids</em> of the clusters, whose trajectories are traced in
detail from information not taken into account in the trajectory
coding.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># medoid of each cluster (line numbers in the data)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/medoids.html" class="external-link">medoids</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">part</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 483 121 103 307 147</code></pre>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="non-typological-analyses">Non-typological analyses<a class="anchor" aria-label="anchor" href="#non-typological-analyses"></a>
</h2>
<div class="section level3">
<h3 id="distance-to-a-reference-sequence">Distance to a reference sequence<a class="anchor" aria-label="anchor" href="#distance-to-a-reference-sequence"></a>
</h3>
<p>Here we define a “reference” sequence corresponding to a continuous
full-time employment trajectory from the age of 18, i.e. a sequence
consisting of 4 years of study followed by 33 years of full-time
employment. For each sequence, its distance from the reference sequence
is then calculated: to what extent do they deviate from this
reference?</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="st">"(1,4)-(2,33)"</span><span class="op">)</span>, informat<span class="op">=</span><span class="st">"SPS"</span>, alphabet<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/alphabet.html" class="external-link">alphabet</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">distref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, refseq <span class="op">=</span> <span class="va">ref</span>, method<span class="op">=</span><span class="st">"OM"</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p>The distribution of these differences is then observed according to
gender and number of children. It can be seen that women’s trajectories
deviate more from the trajectory of continuous full-time employment than
those of men when they have one or more children. The gap is
particularly large for women with three or more children.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">socdem</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sexe</span>,<span class="va">nbenf</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>distref<span class="op">=</span><span class="va">distref</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">nbenf</span>, y<span class="op">=</span><span class="va">distref</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">sexe</span><span class="op">)</span>, notch<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"number of children"</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"distance to reference"</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="inter-or-intra-group-distances">Inter or intra-group distances<a class="anchor" aria-label="anchor" href="#inter-or-intra-group-distances"></a>
</h3>
<p>We compare the distances between female trajectories and the
distances between male trajectories. The male trajectories are clearly
more homogeneous or, to put it another way, the female trajectories are
more diverse.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># intra-cluster distances by gender</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">[</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">==</span><span class="va">x</span>,<span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">==</span><span class="va">x</span><span class="op">]</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>homme femme 
 18.8  38.1 </code></pre>
<p>The distance matrix between trajectories can be summarised
graphically from a <em>multidimensional scaling</em> (MDS). Here we
represent the cloud of individuals in the plane formed by the first two
dimensions, by colouring the points according to their cluster, then we
project the gender as an additional variable. We observe, for example,
that, on the first dimension, clusters 1 and 2 are opposed to each
other, and that men are on the side of clusters 1 and 2.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dissim</span>, k<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mds</span>, type<span class="op">=</span><span class="st">'n'</span>, xlab<span class="op">=</span><span class="st">"axe 1"</span>, ylab<span class="op">=</span><span class="st">"axe 2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, v<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">'lightgray'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">mds</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="va">part</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topleft'</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'cluster'</span>,<span class="fl">1</span><span class="op">:</span><span class="va">nbcl</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">nbcl</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">mds</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span>, col<span class="op">=</span><span class="st">'orange'</span>, cex<span class="op">=</span><span class="fl">1</span>, font<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-42-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="synthetic-indicators-1">Synthetic indicators<a class="anchor" aria-label="anchor" href="#synthetic-indicators-1"></a>
</h3>
<p>We can study the distribution of indicators synthesising trajectories
according to other characteristics of individuals. For example, the time
spent in the different states according to gender: the weight of
inactivity in women’s trajectories can be seen.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># durations in states by gender</span></span>
<span><span class="va">dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqistatd.html" class="external-link">seqistatd</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span></span>
<span><span class="va">durees_sexe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">dur</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">durees_sexe</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">durees_sexe</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cluster"</span>,<span class="va">labs</span><span class="op">)</span></span>
<span><span class="va">durees_sexe</span></span></code></pre></div>
<pre><code>  cluster studies full-time part-time short jobs inactivity military
1   homme     5.5      27.7       0.4        1.2        0.9      1.3
2   femme     5.6      19.8       2.3        1.6        7.7      0.0</code></pre>
<p>We now give an example of an indicator of trajectory complexity,
turbulence, crossed with the year of birth. No noticeable change is
observed.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># turbulence</span></span>
<span><span class="va">turbu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqST.html" class="external-link">seqST</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">annais</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">turbu</span>, type<span class="op">=</span><span class="st">'l'</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">'Birth year'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-44-1.png" width="700"></p>
<p>Other indicators of the complexity of trajectories can be easily
calculated: complexity index (function <code>seqici</code>), individual
entropy (function <code>seqient</code>), number of transitions (function
<code>seqtransn</code>).</p>
</div>
<div class="section level3">
<h3 id="analysis-of-variance">Analysis of variance<a class="anchor" aria-label="anchor" href="#analysis-of-variance"></a>
</h3>
<p>With a single explanatory variable, we measure the share of the
variance (or discrepancy) of dissimilarities explained by the variable
(using a pseudo-R2), as well as a measure of the variability of
trajectories for each of the categories of the variable, i.e. in each
sub-population. In our example, gender explains 7.4% of the variance of
the distances between employment trajectories (see <em>pseudo R2</em> in
the <em>Test values</em> section), and the variability of trajectories
is significantly higher for women than for men (19.1 versus 9.4, see
<em>Discrepancy per level</em> section).</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># analysis of variance, with gender as factor</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/dissassoc.html" class="external-link">dissassoc</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span></span></code></pre></div>
<pre><code>Pseudo ANOVA table:
             SS  df       MSE
Exp    591.0611   1 591.06114
Res   7347.0429 498  14.75310
Total 7938.1040 499  15.90802

Test values  (p-values based on 1000 permutation):
                     t0 p.value
Pseudo F    40.06352676   0.001
Pseudo Fbf  42.94304887   0.001
Pseudo R2    0.07445873   0.001
Bartlett    29.68308216   0.001
Levene     123.83930458   0.001

Inconclusive intervals: 
0.00383  &lt;  0.01  &lt;  0.0162
0.03649  &lt;  0.05  &lt;  0.0635 

Discrepancy per level:
        n discrepancy
homme 226    9.383918
femme 274   19.074005
Total 500   15.876208</code></pre>
<p>It is possible to detail these indicators for each position in time
of the trajectories. Thus, the share of variance explained by gender is
almost nil at the beginning of the trajectory, then increases sharply
between the ages of 18 and around 30 (it is 14% at that time), then
decreases to only 5% at the age of 50.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># analysis of variance for each position in time</span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdiff.html" class="external-link">seqdiff</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">diff</span><span class="op">$</span><span class="va">stat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">diff</span><span class="op">$</span><span class="va">discrepancy</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">14</span><span class="op">:</span><span class="fl">49</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">diff</span>, stat<span class="op">=</span><span class="st">"Pseudo R2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-46-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The variability of women’s and men’s trajectories is low at the
beginning of the trajectory and increases until the age of 21. The
results then diverge according to gender: the variability of women’s
trajectories is maintained until the age of 50, while that of men
decreases sharply after the age of 21 and reaches a very low level
between the ages of 30 and 50.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">diff</span><span class="op">$</span><span class="va">discrepancy</span><span class="op">)</span>, <span class="st">"Set2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">diff</span>, stat<span class="op">=</span><span class="st">"discrepancy"</span>, legend.pos<span class="op">=</span><span class="cn">NA</span>, col<span class="op">=</span><span class="va">pal</span>, lwd<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, fill<span class="op">=</span><span class="va">pal</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">diff</span><span class="op">$</span><span class="va">discrepancy</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-47-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>With several explanatory variables, we obtain the share of variance
explained by all the variables and the decomposition of this share
between the variables. Here, year of birth, gender, level of education
and number of children together explain 16.2% of the variance of the
dissimilarities between employment trajectories: 7.7% for gender, 6.0%
for education, 2.1% for number of children and 0.3% for year of
birth.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># analysis of variance with multiple factors</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/dissmfacw.html" class="external-link">dissmfacw</a></span><span class="op">(</span><span class="va">dissim</span> <span class="op">~</span> <span class="va">annais</span><span class="op">+</span><span class="va">nbenf</span><span class="op">+</span><span class="va">sexe</span><span class="op">+</span><span class="va">diplome</span>, data<span class="op">=</span><span class="va">socdem</span><span class="op">)</span></span></code></pre></div>
<pre><code>  Variable   PseudoF    PseudoR2 p_value
1   annais  1.939020 0.003308502   0.032
2    nbenf  4.147849 0.021232117   0.001
3     sexe 45.251273 0.077211134   0.001
4  diplome 11.654366 0.059656674   0.001
5    Total 11.883983 0.162218781   0.001

Inconclusive intervals: 
0.00383  &lt;  0.01  &lt;  0.0162
0.03649  &lt;  0.05  &lt;  0.0635 </code></pre>
<p>Finally, the analysis of variance can be used to build a decision
tree, also known as an induction tree.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># induction tree</span></span>
<span><span class="va">arbre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtree.html" class="external-link">seqtree</a></span><span class="op">(</span><span class="va">seqact</span> <span class="op">~</span> <span class="va">annais</span><span class="op">+</span><span class="va">nbenf</span><span class="op">+</span><span class="va">sexe</span><span class="op">+</span><span class="va">diplome</span>, data<span class="op">=</span><span class="va">socdem</span>, diss<span class="op">=</span><span class="va">dissim</span>, min.size<span class="op">=</span><span class="fl">0.1</span>, max.depth<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The tree can be presented in textual or graphic form. Note that the
graphical representation requires the installation of the GraphViz
software (see the help of the <code>seqtreedisplay</code> function).</p>
<p>As before, it can be seen that the variable that explains the largest
share of variance in the dissimilarities is gender. Next, for women, the
most discriminating variable is the number of children and, more
specifically, whether or not they have three or more children.
Inactivity and, secondarily, part-time work are more present in the
trajectories of women with at least three children than in those of
others. For men, on the other hand, it is the level of education that is
the most discriminating factor (men enter the labour market later when
they have a diploma higher than or equal to the baccalaureat).</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tree results in textual form</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">arbre</span><span class="op">)</span></span></code></pre></div>
<pre><code>Dissimilarity tree:
 Parameters: min.size=50, max.depth=3, R=1000, pval=0.01 
 Formula: seqact ~ annais + nbenf + sexe + diplome 
 Global R2: 0.12934 

 Fitted tree: 

 |-- Root  (n: 500 disc: 15.876) 
   |-&gt; sexe 0.074459 
             |-- [ homme ]  (n: 226 disc: 9.3839) 
               |-&gt; diplome 0.093027 
                   |-- [ aucun,&lt;bac ]    (n: 131 disc: 8.5907)[(1,4)-(2,3)-(6,1)-(2,29)] * 
                   |-- [ bac,&gt;bac ]    (n: 95 disc: 8.401)[(1,9)-(2,28)] * 
             |-- [ femme ]  (n: 274 disc: 19.074) 
               |-&gt; nbenf 0.045614 
                   |-- [ trois ou + ]    (n: 86 disc: 21.168)[(1,4)-(2,10)-(5,13)-(2,10)] * 
                   |-- [ aucun,un,deux ]    (n: 188 disc: 16.848)[(1,6)-(2,31)] * </code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tree results in graphic form</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtreedisplay.html" class="external-link">seqtreedisplay</a></span><span class="op">(</span><span class="va">arbre</span>,type<span class="op">=</span><span class="st">"d"</span>,border<span class="op">=</span><span class="cn">NA</span>,show.depth<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="http://nicolas.robette.free.fr/Docs/seqtree.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="implicative-statistics">Implicative statistics<a class="anchor" aria-label="anchor" href="#implicative-statistics"></a>
</h3>
<p>To study how trajectories differ between several sub-populations,
Studer proposes to use implicative statistics. This involves
reconstructing, for each population, the sequence of typical states
(Studer, 2012; Struffolino <em>et al</em>, 2016).</p>
<p>Here, military service is typical of men’s trajectories around the
age of 20, followed by full-time employment from the age of 25 onwards.
Inactivity is typical of women’s trajectories, from the age of 18
onwards. Part-time employment is also characteristic, but less markedly
so from the age of 30 onwards.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># implicative statistics</span></span>
<span><span class="va">implic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineRextras/man/seqimplic.html" class="external-link">seqimplic</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span></span>
<span><span class="co"># par(mar=c(2,2,2,2))</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">implic</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, lwd<span class="op">=</span><span class="fl">2</span>, conf.level<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.99</span><span class="op">)</span>, cex.legend<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-53-1.png" width="80%" style="display: block; margin: auto;"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="multidimensional-sequence-analysis">Multidimensional sequence analysis<a class="anchor" aria-label="anchor" href="#multidimensional-sequence-analysis"></a>
</h2>
<div class="section level3">
<h3 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h3>
<p>We begin by loading the data corresponding to three dimensions of the
trajectories of 500 individuals drawn at random in the <em>Biographies
and entourage</em> survey - matrimonial, parental and residential - and
observed between the ages of 14 and 35.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">seqmsa</span><span class="op">)</span></span>
<span><span class="va">trajmat</span> <span class="op">&lt;-</span> <span class="va">seqmsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'smat'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajmat</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  22 variables:
 $ smat14: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat15: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat16: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat17: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat18: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat19: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat20: num  1 3 1 1 3 1 1 1 1 1 ...
 $ smat21: num  1 3 1 1 3 3 1 3 1 1 ...
 $ smat22: num  1 3 1 3 3 3 1 3 1 1 ...
 $ smat23: num  1 3 1 3 3 3 1 3 1 1 ...
 $ smat24: num  1 3 1 3 3 3 1 3 1 1 ...
 $ smat25: num  1 3 3 3 3 3 1 3 2 1 ...
 $ smat26: num  2 3 3 3 3 3 1 3 2 1 ...
 $ smat27: num  2 3 3 3 3 3 1 3 2 1 ...
 $ smat28: num  2 3 3 3 3 3 1 3 3 1 ...
 $ smat29: num  2 3 3 3 3 3 1 3 3 1 ...
 $ smat30: num  2 3 3 3 3 3 1 3 3 1 ...
 $ smat31: num  3 3 3 3 3 3 1 3 3 1 ...
 $ smat32: num  3 3 3 3 2 3 1 3 3 1 ...
 $ smat33: num  3 3 3 3 2 3 3 3 3 1 ...
 $ smat34: num  3 3 3 3 2 3 3 3 3 1 ...
 $ smat35: num  3 3 3 3 2 3 3 3 3 1 ...</code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajenf</span> <span class="op">&lt;-</span> <span class="va">seqmsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'nenf'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajenf</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  22 variables:
 $ nenf14: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf15: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf16: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf17: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf18: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf19: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf20: num  0 0 0 0 1 0 0 0 0 0 ...
 $ nenf21: num  0 1 0 0 1 0 0 0 0 0 ...
 $ nenf22: num  0 1 0 0 1 0 0 0 0 0 ...
 $ nenf23: num  0 1 0 0 1 0 0 0 0 0 ...
 $ nenf24: num  0 1 0 0 1 1 0 0 0 0 ...
 $ nenf25: num  0 1 0 1 1 1 0 1 0 0 ...
 $ nenf26: num  0 1 0 1 1 1 0 1 2 0 ...
 $ nenf27: num  0 1 0 1 1 1 0 1 2 0 ...
 $ nenf28: num  0 1 1 1 1 1 0 2 3 0 ...
 $ nenf29: num  0 2 1 2 1 1 0 2 3 0 ...
 $ nenf30: num  0 2 2 2 1 1 0 3 3 0 ...
 $ nenf31: num  1 2 2 2 1 1 0 3 3 0 ...
 $ nenf32: num  1 2 2 2 1 1 0 3 3 0 ...
 $ nenf33: num  1 2 2 2 2 1 0 3 3 0 ...
 $ nenf34: num  1 2 2 2 2 1 0 3 3 0 ...
 $ nenf35: num  1 2 2 2 2 1 0 3 3 0 ...</code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajlog</span> <span class="op">&lt;-</span> <span class="va">seqmsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'slog'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajlog</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  22 variables:
 $ slog14: num  0 0 0 0 0 0 0 0 0 0 ...
 $ slog15: num  0 0 0 0 0 0 0 0 0 0 ...
 $ slog16: num  0 0 0 0 0 0 0 0 0 0 ...
 $ slog17: num  0 0 0 0 0 0 0 0 1 0 ...
 $ slog18: num  0 0 0 0 0 0 0 0 1 0 ...
 $ slog19: num  0 0 0 0 0 1 0 0 1 0 ...
 $ slog20: num  0 0 0 0 1 1 0 0 0 0 ...
 $ slog21: num  0 0 0 0 1 0 0 0 0 0 ...
 $ slog22: num  0 1 0 1 1 0 0 0 1 0 ...
 $ slog23: num  0 1 0 1 1 1 0 1 1 0 ...
 $ slog24: num  0 1 0 1 1 1 0 1 1 0 ...
 $ slog25: num  0 1 1 1 1 1 0 1 1 0 ...
 $ slog26: num  1 1 1 1 1 1 0 1 1 0 ...
 $ slog27: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog28: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog29: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog30: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog31: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog32: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog33: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog34: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog35: num  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>Three sequence objects (one per dimension) are then defined.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># definition of matrimonial trajectories</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"never"</span>,<span class="st">"unmarried couple"</span>,<span class="st">"married"</span>,<span class="st">"separated"</span><span class="op">)</span></span>
<span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">labs</span><span class="op">)</span>, <span class="st">'Set2'</span><span class="op">)</span></span>
<span><span class="va">seqmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajmat</span>, labels<span class="op">=</span><span class="va">labs</span>, cpal<span class="op">=</span><span class="va">palette</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># definition of parental trajectories</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3+"</span><span class="op">)</span></span>
<span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">labs</span><span class="op">)</span>, <span class="st">'YlOrRd'</span><span class="op">)</span></span>
<span><span class="va">seqenf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajenf</span>, labels<span class="op">=</span><span class="va">labs</span>, cpal<span class="op">=</span><span class="va">palette</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># definition of residential independence trajectories</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"non indep"</span>,<span class="st">"indep"</span><span class="op">)</span></span>
<span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'Set1'</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">seqlog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajlog</span>, labels<span class="op">=</span><span class="va">labs</span>, cpal<span class="op">=</span><span class="va">palette</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="association-between-dimensions">Association between dimensions<a class="anchor" aria-label="anchor" href="#association-between-dimensions"></a>
</h3>
<p>The distance matrix of each dimension is calculated using Optimal
Matching (unique substitution cost equal to 2, <em>indel</em> cost of
1.5).</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># distance matrices of the 3 dimensions</span></span>
<span><span class="va">dmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqmat</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqmat</span>,<span class="st">"CONSTANT"</span>,cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">denf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqenf</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqenf</span>,<span class="st">"CONSTANT"</span>,cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dlog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqlog</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqlog</span>,<span class="st">"CONSTANT"</span>,cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A distance matrix is also calculated from a multiple sequence
analysis (also called “multichannel sequence analysis”). It is decided
here to keep the same costs for each of the dimensions, but this is not
mandatory.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># distance matrix for multidimensional sequences</span></span>
<span><span class="va">dissim.MSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqMD.html" class="external-link">seqdistmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seqmat</span>,<span class="va">seqenf</span>,<span class="va">seqlog</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CONSTANT"</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The extent to which the different dimensions are interrelated is then
investigated, which can be achieved in a number of ways (Piccarreta,
2017). From the correlations, we see that the residential dimension
(“log”) is least related to the distance matrix between multiple
sequences (here called “jsa” for Joint Sequence Analysis). It is
moreover very little associated with the parental dimension (“enf”). The
matrimonial (“mat”) and parental dimensions are the most related.
Cronbach’s alpha examination confirms these results.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assoc.domains.html">assoc.domains</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dmat</span>,<span class="va">denf</span>,<span class="va">dlog</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'mat'</span>,<span class="st">'enf'</span>,<span class="st">'log'</span><span class="op">)</span>, <span class="va">dissim.MSA</span><span class="op">)</span></span>
<span><span class="va">asso</span></span></code></pre></div>
<pre><code>$correlations
$correlations$pearson
      mat   enf   log   jsa
mat 1.000 0.372 0.275 0.797
enf 0.372 1.000 0.090 0.702
log 0.275 0.090 1.000 0.604
jsa 0.797 0.702 0.604 1.000

$correlations$spearman
      mat   enf   log   jsa
mat 1.000 0.370 0.280 0.794
enf 0.370 1.000 0.096 0.705
log 0.280 0.096 1.000 0.565
jsa 0.794 0.705 0.565 1.000


$`mean squared correlations`
$`mean squared correlations`$pearson
[1] 0.498

$`mean squared correlations`$spearman
[1] 0.483


$`Cronbach's alpha`
$`Cronbach's alpha`$`(mat,enf,log)`
[1] 0.494

$`Cronbach's alpha`$`(mat,enf)`
[1] 0.542

$`Cronbach's alpha`$`(mat,log)`
[1] 0.431

$`Cronbach's alpha`$`(enf,log)`
[1] 0.166</code></pre>
<p>An idea of the structure of associations across dimensions can still
be gained by carrying out a Principal Component Analysis (PCA) of the
matrix of correlations between dimensions.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PCA of the matrix of correlations between dimensions</span></span>
<span><span class="va">matcor</span> <span class="op">&lt;-</span> <span class="va">asso</span><span class="op">$</span><span class="va">correlations</span><span class="op">$</span><span class="va">pearson</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">PCA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html" class="external-link">PCA</a></span><span class="op">(</span><span class="va">matcor</span>, scale.unit<span class="op">=</span><span class="cn">F</span>, graph<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/plot.PCA.html" class="external-link">plot.PCA</a></span><span class="op">(</span><span class="va">PCA</span>, choix<span class="op">=</span><span class="st">'varcor'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-63-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Several distance matrices between multiple sequences are then
calculated by excluding one of the dimensions at each one.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dnolog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqMD.html" class="external-link">seqdistmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seqmat</span>,<span class="va">seqenf</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CONSTANT"</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dnomat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqMD.html" class="external-link">seqdistmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seqenf</span>,<span class="va">seqlog</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CONSTANT"</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dnoenf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqMD.html" class="external-link">seqdistmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seqmat</span>,<span class="va">seqlog</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CONSTANT"</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dnolog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dnolog</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dnomat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dnomat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dnoenf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dnoenf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We then examine, for each dimension, the correlation between its
distance matrix and the distance matrix between multiple sequences
excluding that dimension. Once again, we see that it is the residential
dimension that is least associated with the others.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dmat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.numeric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dnomat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.418</code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">denf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.numeric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dnoenf</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.304</code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlog</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.numeric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dnolog</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.216</code></pre>
<p>A final option is to sort the <em>index plots</em> of all dimensions
according to the results of a <em>multidimensional scaling</em> (MDS)
performed for a single dimension (Piccarreta &amp; Lior, 2010). Here,
the sequences are sorted from an MDS of the matrimonial dimension. The
order of the sequences of the other two dimensions seems to follow an
interpretable logic, so we can consider that the dimensions are
sufficiently related to each other to justify an analysis of multiple
sequences.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mds.msa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dmat</span>,k<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.1</span>,<span class="fl">2.1</span>,<span class="fl">2.1</span>,<span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqmat</span>, sortv<span class="op">=</span><span class="va">mds.msa</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqmat</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqenf</span>, sortv<span class="op">=</span><span class="va">mds.msa</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqenf</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqlog</span>, sortv<span class="op">=</span><span class="va">mds.msa</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqlog</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-66-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="typology-of-sequences-via-multidimensional-sequence-analysis-msa">Typology of sequences via <em>Multidimensional Sequence
Analysis</em> (MSA)<a class="anchor" aria-label="anchor" href="#typology-of-sequences-via-multidimensional-sequence-analysis-msa"></a>
</h3>
<p>To obtain a typology, an HAC is made from the distance matrix
resulting from the multiple sequence analysis.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># hierarchical agglomerative clustering</span></span>
<span><span class="va">agnes.MSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissim.MSA</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"ward"</span>, keep.diss<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">agnes.MSA</span><span class="op">)</span>, leaflab<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-67-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>We opt for a typology in 5 classes.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choosing a 5-cluster solution</span></span>
<span><span class="va">nbcl.MSA</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">part.MSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">agnes.MSA</span>, <span class="va">nbcl.MSA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">factor</span></span></code></pre></div>
<p>To obtain the state distribution plots of the clusters of the
typology (one graph per cluster and per dimension) :</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># state distribution plots of the typology</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">nbcl.MSA</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.MSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqmat</span><span class="op">[</span><span class="va">part.MSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'cluster'</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqmat</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.MSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqenf</span><span class="op">[</span><span class="va">part.MSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqenf</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.MSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqlog</span><span class="op">[</span><span class="va">part.MSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqlog</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="typology-of-sequences-via-globally-interdependent-multiple-sequence-analysis-gimsa">Typology of sequences via <em>Globally Interdependent Multiple
Sequence Analysis</em> (GIMSA)<a class="anchor" aria-label="anchor" href="#typology-of-sequences-via-globally-interdependent-multiple-sequence-analysis-gimsa"></a>
</h3>
<p>An alternative to multiple sequence analysis is <em>Globally
Interdependent Multiple Sequence Analysis</em> (GIMSA, see Robette
<em>et al</em>, 2015).</p>
<p>First the data is loaded and coded in sequence. The sequences are : -
400 occupational trajectories of mothers, observed between 14 and 60
years old with the following states: independent, medium/upper
socio-professional category, popular socio-professional category,
inactivity, studies. - 400 employment trajectories of their daughters,
observed during the first 15 years after the end of their studies, with
the following states: studies, inactivity, part-time, full-time.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># loading the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">seqgimsa</span><span class="op">)</span></span>
<span><span class="va">trajfilles</span> <span class="op">&lt;-</span> <span class="va">seqgimsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'f'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajfilles</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   400 obs. of  15 variables:
 $ f1 : num  4 4 4 4 3 4 4 4 4 4 ...
 $ f2 : num  4 4 4 4 4 4 4 4 4 4 ...
 $ f3 : num  4 4 4 4 4 4 4 4 4 2 ...
 $ f4 : num  4 4 4 4 4 4 4 4 4 2 ...
 $ f5 : num  4 4 4 4 4 4 4 2 4 2 ...
 $ f6 : num  4 4 4 4 4 4 4 2 4 2 ...
 $ f7 : num  4 4 4 4 4 4 4 2 4 2 ...
 $ f8 : num  4 4 4 2 4 4 4 2 4 2 ...
 $ f9 : num  4 4 4 4 4 4 4 2 4 2 ...
 $ f10: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f11: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f12: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f13: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f14: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f15: num  4 4 4 4 4 4 4 2 4 2 ...</code></pre>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajmeres</span> <span class="op">&lt;-</span> <span class="va">seqgimsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'m'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajmeres</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   400 obs. of  47 variables:
 $ m14: num  5 5 9 9 8 8 9 9 9 9 ...
 $ m15: num  5 5 9 9 8 8 9 9 9 9 ...
 $ m16: num  5 5 9 9 8 8 9 9 9 9 ...
 $ m17: num  5 5 9 9 8 8 9 9 9 9 ...
 $ m18: num  5 5 9 3 8 8 9 9 3 5 ...
 $ m19: num  5 5 9 3 8 8 9 9 3 5 ...
 $ m20: num  5 5 9 3 8 8 9 9 3 5 ...
 $ m21: num  5 5 9 3 8 8 9 5 3 5 ...
 $ m22: num  5 5 9 3 8 8 9 5 3 5 ...
 $ m23: num  5 5 9 3 8 8 9 5 3 5 ...
 $ m24: num  5 5 9 3 8 8 9 5 3 8 ...
 $ m25: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m26: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m27: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m28: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m29: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m30: num  5 5 9 8 8 8 1 5 3 8 ...
 $ m31: num  5 5 9 8 8 8 1 5 3 8 ...
 $ m32: num  5 5 9 8 8 8 1 5 3 8 ...
 $ m33: num  5 5 9 8 8 8 1 5 3 8 ...
 $ m34: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m35: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m36: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m37: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m38: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m39: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m40: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m41: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m42: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m43: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m44: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m45: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m46: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m47: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m48: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m49: num  8 5 5 9 8 8 1 5 3 8 ...
 $ m50: num  8 5 5 9 8 8 1 5 3 8 ...
 $ m51: num  8 5 5 9 8 8 1 5 3 8 ...
 $ m52: num  8 5 5 9 8 8 1 5 3 8 ...
 $ m53: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m54: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m55: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m56: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m57: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m58: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m59: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m60: num  8 8 5 9 8 8 1 8 8 8 ...</code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># definition of the sequences</span></span>
<span><span class="va">lab.meres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"indep"</span>,<span class="st">"medium/upper"</span>,<span class="st">"popu"</span>,<span class="st">"inactivity"</span>,<span class="st">"studies"</span><span class="op">)</span></span>
<span><span class="va">pal.meres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Set1"</span><span class="op">)</span></span>
<span><span class="va">seqmeres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajmeres</span>,lab<span class="op">=</span><span class="va">lab.meres</span>, cpal<span class="op">=</span><span class="va">pal.meres</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lab.filles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"studies"</span>,<span class="st">"inactivity"</span>,<span class="st">"part-time"</span>,<span class="st">"full-time"</span><span class="op">)</span></span>
<span><span class="va">pal.meres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"Set1"</span><span class="op">)</span></span>
<span><span class="va">seqfilles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajfilles</span>,lab<span class="op">=</span><span class="va">lab.filles</span>, cpla<span class="op">=</span><span class="va">pal.filles</span><span class="op">)</span></span></code></pre></div>
<p>The first step is to calculate a distance matrix for mothers and one
for daughters. The LCS metric is used for mothers and the Hamming
distance for daughters.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step 1 : dissimilarity measure</span></span>
<span><span class="va">dmeres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqmeres</span>,method<span class="op">=</span><span class="st">"LCS"</span><span class="op">)</span></span>
<span><span class="va">cout.filles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqfilles</span>, method<span class="op">=</span><span class="st">"CONSTANT"</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dfilles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqfilles</span>, method<span class="op">=</span><span class="st">"HAM"</span>, sm<span class="op">=</span><span class="va">cout.filles</span><span class="op">)</span></span></code></pre></div>
<p>In the second step, the distance matrices are summarised from an
MDS.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step 2 : multidimensional scaling</span></span>
<span><span class="va">mds.meres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dmeres</span>, k<span class="op">=</span><span class="fl">20</span>, eig<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mds.filles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dfilles</span>, k<span class="op">=</span><span class="fl">20</span>, eig<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The number of dimensions to be retained for each of the MDSs is
selected.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choosing the numbers of dimensions to retain for mothers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># stress measure</span></span>
<span><span class="fu"><a href="../reference/seqmds.stress.html">seqmds.stress</a></span><span class="op">(</span><span class="va">dmeres</span>, <span class="va">mds.meres</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'l'</span>, xlab<span class="op">=</span><span class="st">'number of dimensions'</span>, ylab<span class="op">=</span><span class="st">'stress'</span><span class="op">)</span></span>
<span><span class="co"># share of variance explained</span></span>
<span><span class="op">(</span><span class="va">mds.meres</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">/</span><span class="va">mds.meres</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'s'</span>, xlab<span class="op">=</span><span class="st">'number of dimensions'</span>, ylab<span class="op">=</span><span class="st">'share of variance explained'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-76-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choosing the numbers of dimensions to retain for daughters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># stress measure</span></span>
<span><span class="fu"><a href="../reference/seqmds.stress.html">seqmds.stress</a></span><span class="op">(</span><span class="va">dfilles</span>, <span class="va">mds.filles</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'l'</span>, xlab<span class="op">=</span><span class="st">'number of dimensions'</span>, ylab<span class="op">=</span><span class="st">'stress'</span><span class="op">)</span></span>
<span><span class="co"># share of variance explained</span></span>
<span><span class="op">(</span><span class="va">mds.filles</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">/</span><span class="va">mds.filles</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'s'</span>, xlab<span class="op">=</span><span class="st">'number of dimensions'</span>, ylab<span class="op">=</span><span class="st">'share of variance explained'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-77-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>In the third step, the relationships between the results of the
mothers’ MDS and those of the daughters’ MDS are summarised using a
symmetric PLS.</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step 3 : symmetric PLS</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">mds.meres</span><span class="op">$</span><span class="va">points</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">mds.filles</span><span class="op">$</span><span class="va">points</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">pls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/symPLS.html">symPLS</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span></span></code></pre></div>
<p>In the fourth and final step, a single distance matrix is calculated
between the dyads of mother-daughter trajectories. It is possible to
weight the dimensions of mothers and daughters to balance their
contribution to the final results.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># step : distance and clustering</span></span>
<span></span>
<span><span class="co"># no weighting</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="cn">F</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="va">G</span></span>
<span></span>
<span><span class="co"># weighting by variance of PLS dimensions (w1)</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="cn">F</span>,<span class="fl">2</span>,<span class="va">scale</span>,center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="va">G</span>,<span class="fl">2</span>,<span class="va">scale</span>,center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># weighting by number of distinct sequences (w2)</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="cn">F</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtab.html" class="external-link">seqtab</a></span><span class="op">(</span><span class="va">seqmeres</span>,tlim<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="va">G</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtab.html" class="external-link">seqtab</a></span><span class="op">(</span><span class="va">seqfilles</span>,tlim<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># weighting by 1st MDS eigenvalue (w3)</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="cn">F</span><span class="op">/</span><span class="va">mds.meres</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="va">G</span><span class="op">/</span><span class="va">mds.filles</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>The w1 weighting is used here.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># weighting by variance of PLS dimensions (w1)</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="cn">F</span>,<span class="fl">2</span>,<span class="va">scale</span>,center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="va">G</span>,<span class="fl">2</span>,<span class="va">scale</span>,center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># distance computation</span></span>
<span><span class="va">diff2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">X</span>,upper<span class="op">=</span><span class="cn">T</span>,diag<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">diff2</span><span class="op">(</span><span class="cn">F</span><span class="op">)</span><span class="op">+</span><span class="fu">diff2</span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span></span></code></pre></div>
<p>A clustering procedure is then carried out (here a HAC).</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># clustering</span></span>
<span><span class="va">dist.GIMSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="va">agnes.GIMSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></span><span class="op">(</span><span class="va">dist.GIMSA</span>, method<span class="op">=</span><span class="st">"ward"</span>, keep.diss<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">agnes.GIMSA</span><span class="op">)</span>, leaflab<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-82-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>A partition is chosen in 5 clusters.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># partition in 5 clusters</span></span>
<span><span class="va">nbcl.GIMSA</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">part.GIMSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">agnes.GIMSA</span>, <span class="va">nbcl.GIMSA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">factor</span></span></code></pre></div>
<p>Finally, the typology is represented graphically with the help of
state distribution plots.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">nbcl.GIMSA</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.GIMSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqmeres</span><span class="op">[</span><span class="va">part.GIMSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">60</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'cluster'</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.GIMSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqfilles</span><span class="op">[</span><span class="va">part.GIMSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqmeres</span>, cex<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqfilles</span>, cex<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-84-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://github.com/nicolas-robette" class="external-link">Nicolas Robette</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
