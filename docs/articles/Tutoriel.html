<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>[fr] Tutoriel d'analyse de séquences • seqhandbook</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="[fr] Tutoriel d'analyse de séquences">
<meta property="og:description" content="seqhandbook">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">seqhandbook</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Tutorial.html">[eng] Tutorial on sequence analysis</a>
    </li>
    <li>
      <a href="../articles/Tutoriel.html">[fr] Tutoriel d'analyse de séquences</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>[fr] Tutoriel d’analyse de séquences</h1>
                        <h4 data-toc-skip class="author">Nicolas
Robette</h4>
            
            <h4 data-toc-skip class="date">2023-04-02</h4>
      
      
      <div class="hidden name"><code>Tutoriel.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="mise-en-route">Mise en route<a class="anchor" aria-label="anchor" href="#mise-en-route"></a>
</h2>
<p>On commence par charger les extensions (<em>packages</em>)
nécessaires (qu’il faut au préalable installer si elles ne le sont pas
déjà) : <code class="pkg">TraMineR</code> et <code class="pkg">TraMineRextras</code> pour le traitement des séquences,
<code class="pkg">cluster</code> pour les méthodes de classification
automatique, <code class="pkg">WeightedCluster</code> en complément des
précédentes, <code class="pkg">FactoMineR</code> et <code class="pkg">ade4</code> pour les analyses factorielles, <code class="pkg">RColorBrewer</code> pour les palettes de couleurs, <code class="pkg">questionr</code> et <code class="pkg">descriptio</code> pour
les statistiques descriptives, <code class="pkg">dplyr</code> et <code class="pkg">purrr</code> pour la manipulation de données, <code class="pkg">ggplot2</code> pour les graphiques et <code class="pkg">seqhandbook</code> l’extension qui accompagne le manuel.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://traminer.unige.ch" class="external-link">TraMineR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://traminer.unige.ch/" class="external-link">TraMineRextras</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/" class="external-link">cluster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mephisto.unige.ch/weightedcluster/" class="external-link">WeightedCluster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr" class="external-link">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://juba.github.io/questionr/" class="external-link">questionr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nicolas-robette/descriptio" class="external-link">descriptio</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nicolas-robette.github.io/seqhandbook/">seqhandbook</a></span><span class="op">)</span></span></code></pre></div>
<p>On charge ensuite les données utilisées dans le manuel. Les données
sur les trajectoires d’emploi sont dans le tableau de données (<em>data
frame</em>) <code>trajact</code> : il y a 500 observations, i.e. 500
trajectoires individuelles, et 37 variables, correspondant au statut
d’activité observé chaque année entre 14 ans et 50 ans.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># chargement des trajectoires</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">trajact</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajact</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  37 variables:
 $ sact14: num  2 1 1 1 1 1 1 1 1 1 ...
 $ sact15: num  2 1 1 1 1 1 1 1 1 1 ...
 $ sact16: num  2 1 1 1 1 1 1 1 1 1 ...
 $ sact17: num  2 1 1 1 1 1 2 2 2 2 ...
 $ sact18: num  2 1 2 2 1 1 2 2 2 2 ...
 $ sact19: num  2 3 2 2 1 1 2 2 2 2 ...
 $ sact20: num  2 3 2 6 2 2 5 2 6 2 ...
 $ sact21: num  2 3 2 2 2 2 5 6 6 2 ...
 $ sact22: num  2 3 2 2 2 2 5 6 2 2 ...
 $ sact23: num  2 3 2 2 2 2 5 2 2 2 ...
 $ sact24: num  2 3 2 2 2 5 3 2 2 2 ...
 $ sact25: num  2 3 2 2 2 5 3 2 2 2 ...
 $ sact26: num  2 3 2 2 2 5 3 2 2 2 ...
 $ sact27: num  2 3 2 2 2 2 3 2 2 2 ...
 $ sact28: num  2 3 5 2 2 2 3 2 2 2 ...
 $ sact29: num  2 3 2 2 2 2 3 2 2 2 ...
 $ sact30: num  2 3 5 2 2 2 3 2 2 2 ...
 $ sact31: num  2 3 5 2 2 2 3 2 2 2 ...
 $ sact32: num  2 3 5 2 2 2 5 2 2 2 ...
 $ sact33: num  2 3 5 2 2 2 5 2 2 2 ...
 $ sact34: num  2 3 5 2 2 2 5 2 2 2 ...
 $ sact35: num  2 3 5 2 2 2 2 2 2 2 ...
 $ sact36: num  2 3 5 2 2 2 2 2 2 2 ...
 $ sact37: num  2 3 5 2 2 2 2 2 2 2 ...
 $ sact38: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact39: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact40: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact41: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact42: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact43: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact44: num  2 2 5 2 2 2 2 2 2 2 ...
 $ sact45: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact46: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact47: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact48: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact49: num  2 2 3 2 2 2 2 2 2 2 ...
 $ sact50: num  2 3 3 2 2 2 2 2 2 2 ...</code></pre>
<p>La première étape de l’analyse de séquences consiste à créer un
corpus de séquences, c’est-à-dire un objet de classe
<code>stslist</code> à l’aide la fonction <code>seqdef</code>. On
définit d’abord les labels des 6 états et une palette de 6 couleurs
(c’est facultatif: <code>seqdef</code> crée labels et palette de manière
automatique si on ne lui fournit pas).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># définition du corpus de séquences</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"études"</span>,<span class="st">"temps plein"</span>,<span class="st">"temps partiel"</span>,<span class="st">"petits boulots"</span>,<span class="st">"inactivité"</span>,<span class="st">"serv. militaire"</span><span class="op">)</span></span>
<span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">labs</span><span class="op">)</span>, <span class="st">'Set2'</span><span class="op">)</span></span>
<span><span class="va">seqact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajact</span>, labels<span class="op">=</span><span class="va">labs</span>, cpal<span class="op">=</span><span class="va">palette</span><span class="op">)</span></span></code></pre></div>
<p>Notre corpus de 500 séquences comporte 377 séquences distinctes, ce
qui confirme l’intérêt d’utiliser une procédure statistique pour
regrouper les séquences qui se ressemblent.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># nombre de séquences distinctes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtab.html" class="external-link">seqtab</a></span><span class="op">(</span><span class="va">seqact</span>, idx<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">nrow</span></span></code></pre></div>
<pre><code>[1] 377</code></pre>
<p>Le chronogramme (<em>state distribution plot</em>) de l’ensemble des
séquences fait apparaître la prépondérance de l’emploi à temps plein et
le poids non négligeable de l’inactivité.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># chronogramme</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqact</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, cex.legend<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/fig1-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>On charge également un tableau de données contenant quelques
variables socio-démographiques sur les individus. A noter, les variables
catégorielles sont au format <code>factor</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># chargement des variables socio-démographiques</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  9 variables:
 $ annais     : num  1950 1937 1933 1948 1944 ...
 $ nbenf      : Factor w/ 4 levels "aucun","un","deux",..: 4 3 3 3 3 2 4 4 4 1 ...
 $ nbunion    : Factor w/ 3 levels "aucune","une",..: 2 2 2 2 3 2 2 2 2 1 ...
 $ mereactive : Factor w/ 2 levels "non","oui": 1 1 2 2 1 1 2 1 1 2 ...
 $ sexe       : Factor w/ 2 levels "homme","femme": 1 2 2 1 2 2 2 1 1 2 ...
 $ PCS        : Factor w/ 8 levels "NA","agric","indep",..: 7 8 5 7 6 5 6 7 7 4 ...
 $ PCSpere    : Factor w/ 8 levels "agric","indep",..: 7 1 5 2 6 3 6 5 6 6 ...
 $ diplome    : Factor w/ 4 levels "aucun","&lt;bac",..: 1 2 2 2 3 4 2 2 2 2 ...
 $ nationalite: Factor w/ 2 levels "francaise","etrangere": 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<hr>
</div>
<div class="section level2">
<h2 id="construction-dune-matrice-de-distance">Construction d’une matrice de distance<a class="anchor" aria-label="anchor" href="#construction-dune-matrice-de-distance"></a>
</h2>
<div class="section level3">
<h3 id="indicateurs-synthétiques">Indicateurs synthétiques<a class="anchor" aria-label="anchor" href="#indicateurs-synth%C3%A9tiques"></a>
</h3>
<p>A titre d’exemple, on construit une matrice de distance à partir
d’indicateurs décrivant le nombre d’épisodes dans les différents états.
Le premier individu a passé l’ensemble de sa trajectoire en emploi à
temps plein, alors que le second a connu un épisode de temps plein mais
aussi un épisode d’études et deux de temps partiel.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seqinepi.html">seqinepi</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">indics</span><span class="op">)</span></span></code></pre></div>
<pre><code>  nepi1 nepi2 nepi3 nepi4 nepi5 nepi6
1     0     1     0     0     0     0
2     1     1     2     0     0     0
3     1     2     1     0     2     0
4     1     2     0     0     0     1
5     1     1     0     0     0     0
6     1     2     0     0     1     0</code></pre>
<p>La matrice peut être calculée directement à partir des indicateurs ou
après une étape d’analyse en composantes principales (ACP), ici en
retenant les 5 premières dimensions.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># matrice de distance à partir des indicateurs</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">indics</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># matrice de distance à partir des résultats d'une ACP</span></span>
<span><span class="va">acp_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html" class="external-link">PCA</a></span><span class="op">(</span><span class="va">indics</span>, scale.unit<span class="op">=</span><span class="cn">FALSE</span>, ncp<span class="op">=</span><span class="fl">5</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">acp_coords</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span></code></pre></div>
<p>D’autres indicateurs synthétiques (durées, états visités, etc.)
peuvent être calculés simplement à partir des fonctions
<code>seqistatd</code>, <code>seqi1epi</code>, <code>seqifpos</code>,
<code>seqindic</code> ou <code>seqpropclust</code>.</p>
</div>
<div class="section level3">
<h3 id="disjonctif-complet-et-ahq">Disjonctif complet et AHQ<a class="anchor" aria-label="anchor" href="#disjonctif-complet-et-ahq"></a>
</h3>
<p>Dans le cas du codage sous forme de disjonctif complet, la matrice de
distance peut être calculée directement, avec la distance euclidienne ou
la distance du chi2, ou après une étape d’analyse en composantes
principales (ACP) ou d’analyse des correspondances multiples (ACM), ici
en retenant les 5 premières dimensions.</p>
<p>NB : <code>map_df</code> permet d’appliquer une même fonction à
l’ensemble des colonnes d’un tableau de données. Ici, cette fonction est
utilisée pour convertir les colonnes du format numérique vers le format
<code>factor</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># codage disjonctif complet</span></span>
<span><span class="va">disjo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/tab.disjonctif.html" class="external-link">tab.disjonctif</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">disjo</span> <span class="op">&lt;-</span> <span class="va">disjo</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">disjo</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># distance euclidienne</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">disjo</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># distance du chi2</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">disjo</span>, <span class="va">as.factor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.acm.html" class="external-link">dudi.acm</a></span><span class="op">(</span>scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">disjo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dist.dudi.html" class="external-link">dist.dudi</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># après une ACP</span></span>
<span><span class="va">acp_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html" class="external-link">PCA</a></span><span class="op">(</span><span class="va">disjo</span>, scale.unit<span class="op">=</span><span class="cn">FALSE</span>, ncp<span class="op">=</span><span class="fl">5</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">acp_coords</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># après une ACM</span></span>
<span><span class="va">acm_res</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">disjo</span>, <span class="va">as.factor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/MCA.html" class="external-link">MCA</a></span><span class="op">(</span>ncp<span class="op">=</span><span class="fl">5</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">acm_res</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span></code></pre></div>
<p>Pour l’analyse harmonique qualitative (AHQ), le calcul de la matrice
de distance peut se faire directement (distance du chi2) ou après une
analyse factorielle des correspondances (AFC), ici en retenant les 5
premières dimensions.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># codage AHQ</span></span>
<span><span class="va">ahq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seq2qha.html">seq2qha</a></span><span class="op">(</span><span class="va">seqact</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">28</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ahq</span> <span class="op">&lt;-</span> <span class="va">ahq</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">ahq</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># distance du chi2</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.coa.html" class="external-link">dudi.coa</a></span><span class="op">(</span><span class="va">ahq</span>, scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ahq</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dist.dudi.html" class="external-link">dist.dudi</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="va">as.matrix</span></span>
<span></span>
<span><span class="co"># après une AFC</span></span>
<span><span class="va">afc_coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/CA.html" class="external-link">CA</a></span><span class="op">(</span><span class="va">ahq</span>, ncp<span class="op">=</span><span class="fl">5</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">row</span><span class="op">$</span><span class="va">coord</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">afc_coord</span>, method<span class="op">=</span><span class="st">'euclidean'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.matrix</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optimal-matching-et-alternatives">
<em>Optimal Matching</em> et alternatives<a class="anchor" aria-label="anchor" href="#optimal-matching-et-alternatives"></a>
</h3>
<p>Pour l’<em>Optimal Matching</em>, la construction d’une matrice de
distance entre les séquences s’effectue avec la fonction
<code>seqdist</code>. Cela implique de définir également une matrice de
coûts de substitution entre les états (avec la fonction
<code>seqsubm</code>). Ici, les coûts de substitution sont constants et
égaux à 2 et le coût <em>indel</em> est égal à 1,5.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># construction de la matrice de distance</span></span>
<span><span class="va">couts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"CONSTANT"</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"OM"</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p>D’expérience, l’<em>Optimal Matching</em> avec le paramétrage adopté
ici constitue un choix permettant de prendre en compte les différentes
dimensions de la temporalité des séquences - ordonnancement
(<em>sequencing</em>), calendrier (<em>timing</em>), durée (dans les
différents états ou des épisodes, <em>duration</em> et <em>spell
duration</em>). Si on souhaite privilégier l’une de ces dimensions, on
peut suivre les recommandations de Studer &amp; Ritschard (2016, voir en
particulier pages 507-509), et choisir l’une des nombreuses autres
métriques implémentées dans l’extension <code>TraMineR</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sequencing</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"OMstran"</span>, otto<span class="op">=</span><span class="fl">0.1</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"OMspell"</span>, expcost<span class="op">=</span><span class="fl">0</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"SVRspell"</span>, tpow<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># timing</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"HAM"</span>, sm<span class="op">=</span><span class="va">couts</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"CHI2"</span>, step<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># duration (distribution aver the entire period)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"EUCLID"</span>, step<span class="op">=</span><span class="fl">37</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># duration (spell lengths)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"OMspell"</span>, expcost<span class="op">=</span><span class="fl">1</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, method<span class="op">=</span><span class="st">"LCS"</span><span class="op">)</span></span></code></pre></div>
<p>A noter, les méthodes passant par le disjonctif complet ou l’AHQ sont
également implémentées dans la fonction <code>seqdist</code> (méthodes
“EUCLID” et “CHI2”).</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="typologie-de-séquences">Typologie de séquences<a class="anchor" aria-label="anchor" href="#typologie-de-s%C3%A9quences"></a>
</h2>
<div class="section level3">
<h3 id="construction-dune-typologie">Construction d’une typologie<a class="anchor" aria-label="anchor" href="#construction-dune-typologie"></a>
</h3>
<p>On réalise ensuite une classification ascendante hiérarchique (CAH)
avec le critère d’agrégation de Ward, à l’aide de la fonction
<code>agnes</code> de l’extension <code>cluster</code>.</p>
<p>NB : Avec un nombre élevé de séquences, la CAH peut nécessiter un
temps de calcul important. Il existe cependant une implémentation
nettement plus rapide dans l’extension <code>fastcluster</code>
(fonction <code>hclust</code>).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># classification ascendante hiérarchique</span></span>
<span><span class="va">agnes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"ward"</span>, keep.diss<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Pour explorer les solutions d’une classification ascendante
hiérarchique, on commence généralement par examiner le dendrogramme.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># dendrogramme</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">agnes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>leaflab<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Le graphique suivant combine dendrogramme et <em>index plot</em>: les
séquences de l’index plot sont triées selon leur position dans le
dendrogramme, lui-même représenté en marge du graphique.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># heatmap (dendrogramme + index plot)</span></span>
<span><span class="fu"><a href="../reference/seq_heatmap.html">seq_heatmap</a></span><span class="op">(</span><span class="va">seqact</span>, <span class="va">agnes</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-14-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>L’examen des sauts d’inertie peut également être utile pour
déterminer le nombre de classes de la typologie. On voit par exemple
qu’il y a une différence d’inertie notable entre les partitions en 5 et
6 classes.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># graphique des sauts d'inertie</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">agnes</span><span class="op">$</span><span class="va">height</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"s"</span>, xlab<span class="op">=</span><span class="st">"nombre de classes"</span>, ylab<span class="op">=</span><span class="st">"inertie"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-15-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Il existe aussi un certain nombre d’indicateurs de qualité des
partitions (silhouette, Calinski-Harabasz, pseudo-R2, etc.; voir Studer,
2013).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># indicateurs de qualité</span></span>
<span><span class="va">wardRange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WeightedCluster/man/as.clustrange.html" class="external-link">as.clustrange</a></span><span class="op">(</span><span class="va">agnes</span>, diss<span class="op">=</span><span class="va">dissim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wardRange</span>, max.rank<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>     1. N groups     1.  stat 2. N groups     2.  stat
PBC            5   0.79612318           4   0.79012613
HG             5   0.92899997           4   0.92259604
HGSD           5   0.92672338           4   0.92027518
ASW            3   0.53491169           2   0.52958820
ASWw           3   0.53862662           2   0.53182999
CH             2 156.86409716           3 103.74539004
R2            20   0.60648740          19   0.59473652
CHsq           2 324.53910100           3 245.89231855
R2sq          20   0.82862437          19   0.82073439
HC             5   0.04010082           4   0.04392402</code></pre>
<p>On représente ici graphiquement la qualité des partitions pour
différents nombres de classes pour les indicateurs silhouette, pseudo-R2
et Calinski-Harabasz.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wardRange</span>, stat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ASW'</span>,<span class="st">'R2'</span>,<span class="st">'CH'</span><span class="op">)</span>, norm<span class="op">=</span><span class="st">"zscore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-17-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>On opte au final pour une partition en 5 classes, en “coupant
l’arbre” de la CAH à l’aide de la fonction <code>cutree</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choix de la partition en 5 classes</span></span>
<span><span class="va">nbcl</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">part</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">agnes</span>, <span class="va">nbcl</span><span class="op">)</span></span></code></pre></div>
<p>Il est possible de “consolider” la partition à l’aide de l’algorithme
PAM (<em>Partition Around Medoids</em>) et de la fonction
<code>wcKMedoids</code> de l’extension <code>WeightedCluster</code>. On
aboutit ainsi à une distribution des séquences entre les classes très
similaire (cf le tri croisant les classes avant et après consolidation)
mais la qualité de la partition consolidée est légèrement supérieure (le
R² passe de 61 à 64%).</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># consolidation de la partition</span></span>
<span><span class="va">newpart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WeightedCluster/man/kmedoids.html" class="external-link">wcKMedoids</a></span><span class="op">(</span><span class="va">dissim</span>, k<span class="op">=</span><span class="va">nbcl</span>, initialclust<span class="op">=</span><span class="va">part</span>, cluster.only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">part</span>, <span class="va">newpart</span><span class="op">)</span></span></code></pre></div>
<pre><code>    newpart
part  28  34 103 307 480
   1 104 241   1   0   0
   2   9  24   2   7   0
   3   0   6   6  63   1
   4   0   0  17   0   0
   5   8   0   0   1  10</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/WeightedCluster/man/clusterquality.html" class="external-link">wcClusterQuality</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">part</span><span class="op">)</span><span class="op">$</span><span class="va">stats</span><span class="op">[</span><span class="st">'R2sq'</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span> <span class="va">R2sq</span> </span>
<span><span class="fl">0.607</span> </span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/WeightedCluster/man/clusterquality.html" class="external-link">wcClusterQuality</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">newpart</span><span class="op">)</span><span class="op">$</span><span class="va">stats</span><span class="op">[</span><span class="st">'R2sq'</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="va">R2sq</span> </span>
<span><span class="fl">0.64</span> </span></code></pre>
<p>Si on souhaite conserver la partition consolidée :</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">part</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">newpart</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>NB : Autre option, la classification “floue”, ici avec l’algorithme
Fanny (extension <code>cluster</code>). A la différence de la CAH ou de
PAM, chaque séquence n’appartient pas à une seule classe mais se
caractérise par des degrés d’appartenance aux différentes classes. Le
tableau suivant présente les degrés d’appartenance aux 6 classes des 3
premières séquences du corpus. La première séquence appartient à 99% à
la classe 1, mais la seconde est plus “partagée”, principalement entre
les classes 2 et 5.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># classification floue (fuzzy clustering)</span></span>
<span><span class="va">fanny</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/fanny.html" class="external-link">fanny</a></span><span class="op">(</span>k<span class="op">=</span><span class="fl">5</span>, metric<span class="op">=</span><span class="st">'euclidean'</span>, memb.exp<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="va">fanny</span><span class="op">$</span><span class="va">membership</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">.</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre></div>
<pre><code>  [,1] [,2] [,3] [,4] [,5]
1 0.99 0.00 0.00 0.01 0.00
2 0.06 0.51 0.02 0.13 0.28
3 0.00 0.11 0.80 0.00 0.08</code></pre>
</div>
<div class="section level3">
<h3 id="description-de-la-typologie-graphiques">Description de la typologie: graphiques<a class="anchor" aria-label="anchor" href="#description-de-la-typologie-graphiques"></a>
</h3>
<p>Les représentations graphiques permettent de se faire une idée rapide
et intuitive de la nature des classes de la typologie. Le type de
graphique le plus utilisé est le chronogramme (<em>state distribution
plot</em>).</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># chronogrammes de la typologie</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, border<span class="op">=</span><span class="cn">NA</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-22-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Les <em>index plots</em> (ou “tapis”) sont également très
répandus.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># index plots de la typologie</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-23-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Les <em>index plots</em> sont souvent plus faciles à interpréter
lorsqu’on trie les séquences, en particulier à partir d’une procédure de
<em>multidimensional scaling</em>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># index plots de la typologie, triés par multidimensional scaling</span></span>
<span><span class="va">mds.order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dissim</span>,k<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqact</span>, sortv<span class="op">=</span><span class="va">mds.order</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-24-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Ils peuvent également être “lissés”, pour les rendre plus
lisibles.</p>
<p>Méthode des “<em>smoothed MDS sequence plots</em>” (Piccarreta,
2012):</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoothed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seqsmooth.html">seqsmooth</a></span><span class="op">(</span><span class="va">seqact</span>, <span class="va">dissim</span>, k<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">$</span><span class="va">seqdata</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">smoothed</span>, sortv<span class="op">=</span><span class="va">mds.order</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>Méthode des “<em>relative frequency sequence plots</em>” (Fasang
&amp; Liao, 2013):</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># relative frequency sequence plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineRextras/man/seqplot-rf.html" class="external-link">seqplot.rf</a></span><span class="op">(</span><span class="va">seqact</span>, diss<span class="op">=</span><span class="va">dissim</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, which.plot<span class="op">=</span><span class="st">"medoids"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-26-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Les <em>sequence frequency plots</em> représentent, pour chaque
classe, les 10 séquences les plus fréquentes (avec une épaisseur
proportionnelle à leur fréquence).</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># frequency plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqfplot</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">part</span>, ylab<span class="op">=</span><span class="st">""</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-27-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Les <em>modal state sequence plots</em> représentent, pour chaque
classe, la séquence des états modaux pour chaque position dans le temps.
A chaque position dans le temps, la hauteur de la barre est
proportionnelle à la fréquence de l’état modal.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># modal state plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqmsplot</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">part</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, cex.legend<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-28-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="description-de-la-typologie-statistiques">Description de la typologie: statistiques<a class="anchor" aria-label="anchor" href="#description-de-la-typologie-statistiques"></a>
</h3>
<p>La première étape de description statistique de la typologie consiste
généralement à présenter le poids des classes. La classe 2 rassemble
plus de la moitié des individus, alors que les classes 3 et 5 sont de
très petite taille.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># effectifs et pourcentages</span></span>
<span><span class="fu"><a href="https://juba.github.io/questionr/reference/freq.html" class="external-link">freq</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span></span></code></pre></div>
<pre><code>    n    % val%
1 121 24.2 24.2
2 271 54.2 54.2
3  26  5.2  5.2
4  71 14.2 14.2
5  11  2.2  2.2</code></pre>
<p>Il est utile d’évaluer l’homogénéité des classes. Cela peut se faire
à partir des distances intra-classes. Les classes 1 et 2 sont les plus
homogènes.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># distances intra-classes</span></span>
<span><span class="va">Dintra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span>length<span class="op">=</span><span class="va">nbcl</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl</span><span class="op">)</span> <span class="va">Dintra</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">[</span><span class="va">part</span><span class="op">==</span><span class="va">i</span>,<span class="va">part</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Dintra</span></span></code></pre></div>
<pre><code>[1] 18.3 15.2 30.2 28.4 24.3</code></pre>
<p>Les résultats sont convergents à partir des distances moyennes aux
centres de classe :</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># distances moyennes au centre de la classe</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/dissassoc.html" class="external-link">dissassoc</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">part</span><span class="op">)</span><span class="op">$</span><span class="va">groups</span></span></code></pre></div>
<pre><code>        n discrepancy
1     121    9.171231
2     271    7.617135
3      26   15.078402
4      71   14.208490
5      11   12.173554
Total 500   15.876208</code></pre>
<p>De même avec l’entropie transversale :</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># entropie transversale moyenne par classe</span></span>
<span><span class="va">entropie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl</span><span class="op">)</span> <span class="va">entropie</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">seqstatd</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">[</span><span class="va">part</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">Entropy</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">entropie</span></span></code></pre></div>
<pre><code>[1] 0.33 0.27 0.47 0.46 0.36</code></pre>
<p>Pour donner une vision plus détaillée de la forme des trajectoires de
chaque classe, on calcule des indicateurs synthétiques, puis leur
moyenne selon la classe de la typologie. La durée passée dans les états
:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># durées dans les états selon la classe</span></span>
<span><span class="va">dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqistatd.html" class="external-link">seqistatd</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span></span>
<span><span class="va">durees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">dur</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">durees</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">durees</span></span></code></pre></div>
<pre><code>  Group.1    1    2    3    4    5   6
1       1 10.2 23.1  0.7  0.7  1.3 1.0
2       2  3.5 29.9  0.4  0.9  1.7 0.6
3       3  6.3  9.2 16.4  1.0  4.0 0.0
4       4  5.0  7.1  1.2  1.6 22.0 0.1
5       5  7.0  3.6  0.6 22.8  2.7 0.2</code></pre>
<p>La part d’individus ayant connu au moins un épisode dans les états
:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># au moins un épisode dans les états, selon la classe</span></span>
<span><span class="va">epi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seqi1epi.html">seqi1epi</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span></span>
<span><span class="va">episodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">epi</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">episodes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">episodes</span></span></code></pre></div>
<pre><code>  Group.1 epi1 epi2 epi3 epi4 epi5 epi6
1       1 1.00 0.99 0.16 0.14 0.32 0.36
2       2 0.86 1.00 0.06 0.17 0.31 0.35
3       3 0.92 0.73 1.00 0.15 0.62 0.04
4       4 0.86 0.75 0.24 0.24 1.00 0.03
5       5 0.91 0.82 0.27 1.00 0.36 0.09</code></pre>
<p>Ensuite, on croise la typologie avec les caractéristiques des
individus. On commence par une analyse bivariée du type de trajectoire
selon le sexe. Le V² de Cramer est de 0,40, indiquant une association
notable. Les femmes sont très sur-représentées dans la classe 4 et
secondairement dans la classe 3, alors que les hommes sont
sur-représentés dans les classes 1 et 2 (les valeurs “phi” correspondent
aux attractions ou répulsions entre modalités).</p>
<p>NB : Les deux objets <code>part</code> et <code>socdem</code> ne
doivent pas avoir été triés. Si c’est malgré tout le cas, il faut les
fusionner à partir d’un identfiant commun, ou les retrier selon l’ordre
initial.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nicolas-robette.github.io/descriptio/reference/assoc.twocat.html" class="external-link">assoc.twocat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span>, <span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span></span>
<span><span class="va">asso</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">cramer.v</span></span></code></pre></div>
<pre><code>[1] 0.401948</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asso</span><span class="op">$</span><span class="va">local</span><span class="op">$</span><span class="va">phi</span></span></code></pre></div>
<pre><code>        homme       femme
1  0.16239591 -0.16239591
2  0.18154113 -0.18154113
3 -0.17650554  0.17650554
4 -0.33493171  0.33493171
5 -0.02662907  0.02662907</code></pre>
<p>On examine ensuite les sur-représentations pour chaque classe de la
typologie à partir de l’ensemble des caractéristiques individuelles
présentes dans le tableau de données <code>socdem</code>. On constate
tout d’abord que seules trois variables ne semblent pas notablement
liées au type de trajectoire (mereactive, nbunion, nationalite). Pour ne
prendre que l’exemple de la classe 4, on voit que les femmes y sont
sur-représentées, ainsi que les individus ayant trois enfants ou plus,
sans diplôme ou de PCS inconnue (ce qui n’est certainement pas sans lien
avec l’inactivité).</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://nicolas-robette.github.io/descriptio/reference/catdesc.html" class="external-link">catdesc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">part</span><span class="op">)</span>, <span class="va">socdem</span>, limit <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code>$variables
     variable  measure association
1        sexe Cramer V       0.402
2         PCS Cramer V       0.362
3     diplome Cramer V       0.330
4     PCSpere Cramer V       0.202
5       nbenf Cramer V       0.146
6  mereactive Cramer V       0.130
7     nbunion Cramer V       0.094
8 nationalite Cramer V       0.057
9      annais     Eta2       0.041

$bylevel
$bylevel$`1`
$bylevel$`1`$categories
       categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
1    diplome.&gt;bac            0.598            0.628           0.254  0.486
3        PCS.pcis            0.579            0.512           0.214  0.411
7    PCSpere.pcis            0.519            0.331           0.154  0.276
12     sexe.homme            0.319            0.595           0.452  0.162
16    nbenf.aucun            0.367            0.182           0.120  0.107
19    diplome.bac            0.342            0.223           0.158  0.101
21      PCS.oqual            0.098            0.033           0.082 -0.101
22  PCSpere.agric            0.106            0.041           0.094 -0.102
25         PCS.NA            0.111            0.066           0.144 -0.125
27 PCSpere.onqual            0.058            0.025           0.104 -0.147
28  diplome.aucun            0.075            0.041           0.134 -0.154
29     sexe.femme            0.179            0.405           0.548 -0.162
31       PCS.empl            0.107            0.107           0.242 -0.178
39   diplome.&lt;bac            0.057            0.107           0.454 -0.393

$bylevel$`1`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global  cor
3    annais             1945            1943             4            5 0.08


$bylevel$`2`
$bylevel$`2`$categories
       categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
5    diplome.&lt;bac            0.722            0.605           0.454  0.330
8       PCS.oqual            0.878            0.133           0.082  0.202
10     sexe.homme            0.642            0.535           0.452  0.182
13       PCS.empl            0.678            0.303           0.242  0.154
14  PCSpere.oqual            0.670            0.262           0.212  0.133
18 PCSpere.onqual            0.692            0.133           0.104  0.103
32     sexe.femme            0.460            0.465           0.548 -0.182
33         PCS.NA            0.306            0.081           0.144 -0.195
35       PCS.pcis            0.308            0.122           0.214 -0.245
36   PCSpere.pcis            0.195            0.055           0.154 -0.297
38   diplome.&gt;bac            0.228            0.107           0.254 -0.367

$bylevel$`2`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global    cor
5    annais             1942            1943             5            5 -0.102


$bylevel$`3`
$bylevel$`3`$categories
   categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
11 sexe.femme            0.088            0.923           0.548  0.177
30 sexe.homme            0.009            0.077           0.452 -0.177

$bylevel$`3`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global   cor
1    annais             1947            1943             2            5 0.139


$bylevel$`4`
$bylevel$`4`$categories
         categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global    phi
2            PCS.NA            0.542            0.549           0.144  0.470
4        sexe.femme            0.248            0.958           0.548  0.335
9  nbenf.trois ou +            0.235            0.535           0.324  0.184
15    diplome.aucun            0.239            0.225           0.134  0.109
17   mereactive.non            0.173            0.704           0.578  0.104
20        PCS.oqual            0.024            0.014           0.082 -0.101
23   mereactive.oui            0.100            0.296           0.422 -0.104
24     diplome.&gt;bac            0.079            0.141           0.254 -0.106
26         PCS.pint            0.065            0.113           0.248 -0.127
34         PCS.pcis            0.009            0.014           0.214 -0.198
37       sexe.homme            0.013            0.042           0.452 -0.335

$bylevel$`4`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global    cor
4    annais             1942            1943             5            5 -0.079


$bylevel$`5`
$bylevel$`5`$categories
  categories pct.ycat.in.xcat pct.xcat.in.ycat pct.xcat.global   phi
6  PCS.agric                1            0.091           0.002 0.298

$bylevel$`5`$continuous.var
  variables median.x.in.ycat median.x.global mad.x.in.ycat mad.x.global   cor
2    annais             1948            1943             0            5 0.087</code></pre>
</div>
<div class="section level3">
<h3 id="description-de-la-typologie-parangons">Description de la typologie: parangons<a class="anchor" aria-label="anchor" href="#description-de-la-typologie-parangons"></a>
</h3>
<p>Pour “incarner” la typologie, on recourt parfois aux parangons
(<em>medoids</em>) des classes, dont on retrace de manière détaillée les
trajectoires à partir d’informations non prises en compte dans le codage
des trajectoires.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parangon de chaque classe (numéros de ligne dans le fichier de données)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/medoids.html" class="external-link">medoids</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">part</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 483 121 103 307 147</code></pre>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="analyses-non-typologiques">Analyses non-typologiques<a class="anchor" aria-label="anchor" href="#analyses-non-typologiques"></a>
</h2>
<div class="section level3">
<h3 id="distance-à-une-séquence-de-référence">Distance à une séquence de référence<a class="anchor" aria-label="anchor" href="#distance-%C3%A0-une-s%C3%A9quence-de-r%C3%A9f%C3%A9rence"></a>
</h3>
<p>On définit ici une séquence “de référence” correspondant à une
trajectoire d’emploi à temps plein en continu à partir de 18 ans,
c’est-à-dire une séquence composée de 4 années d’études puis de 33
années d’emploi à temps plein. On calcule ensuite, pour chaque séquence,
sa distance à la séquence de référence: dans quelle mesure
s’écartent-elles de cette référence ?</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="st">"(1,4)-(2,33)"</span><span class="op">)</span>, informat<span class="op">=</span><span class="st">"SPS"</span>, alphabet<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/alphabet.html" class="external-link">alphabet</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">distref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqact</span>, refseq <span class="op">=</span> <span class="va">ref</span>, method<span class="op">=</span><span class="st">"OM"</span>, sm<span class="op">=</span><span class="va">couts</span>, indel<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p>On observe ensuite la distribution de ces écarts en fonction du sexe
et du nombre d’enfants. On constate que les trajectoires des femmes
s’écartent plus de la trajectoire d’emploi continu à temps plein que
celles des hommes lorsqu’elles ou ils ont un ou plusieurs enfants.
L’écart est particulièrement fort chez les femmes ayant trois enfants ou
plus.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">socdem</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sexe</span>,<span class="va">nbenf</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>distref<span class="op">=</span><span class="va">distref</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">nbenf</span>, y<span class="op">=</span><span class="va">distref</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">sexe</span><span class="op">)</span>, notch<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"nombre d'enfants"</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"distance à la référence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="distances-inter-ou-intra-groupes">Distances inter ou intra-groupes<a class="anchor" aria-label="anchor" href="#distances-inter-ou-intra-groupes"></a>
</h3>
<p>On compare les distances entre les trajectoires féminines et les
distances entre trajectoires masculines. Les trajectoires masculines
sont nettement plus homogènes ou, pour le dire autrement, celles des
femmes sont plus diversifiées.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># distances intra-classes selon le sexe</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">[</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">==</span><span class="va">x</span>,<span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">==</span><span class="va">x</span><span class="op">]</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>homme femme 
 18.8  38.1 </code></pre>
<p>La matrice de distance entre trajectoires peut être résumée
graphiquement à partir d’un <em>multidimensional scaling</em> (MDS). On
représente ici le nuage des individus dans le plan formé par les deux
premiers axes, en colorant les points selon leur classe, puis on
projette le sexe en variable supplémentaire. On observe par exemple que,
sur le premier axe, les classes 1 et 2 s’opposent aux autres, et que les
hommes sont du côté des classes 1 et 2.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dissim</span>, k<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mds</span>, type<span class="op">=</span><span class="st">'n'</span>, xlab<span class="op">=</span><span class="st">"axe 1"</span>, ylab<span class="op">=</span><span class="st">"axe 2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, v<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">'lightgray'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">mds</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="va">part</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topleft'</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'classe'</span>,<span class="fl">1</span><span class="op">:</span><span class="va">nbcl</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">nbcl</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">mds</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span>, col<span class="op">=</span><span class="st">'orange'</span>, cex<span class="op">=</span><span class="fl">1</span>, font<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-42-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="indicateurs-synthétiques-1">Indicateurs synthétiques<a class="anchor" aria-label="anchor" href="#indicateurs-synth%C3%A9tiques-1"></a>
</h3>
<p>On peut étudier la distribution d’indicateurs synthétisant les
trajectoires en fonction d’autres caractéristiques des individus. Par
exemple, le temps passé dans les différents états selon le sexe : on
voit apparaître le poids de l’inactivité dans les trajectoires
féminines.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># durées dans les états selon le sexe</span></span>
<span><span class="va">dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqistatd.html" class="external-link">seqistatd</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span></span>
<span><span class="va">durees_sexe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">dur</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">durees_sexe</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">durees_sexe</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classe"</span>,<span class="va">labs</span><span class="op">)</span></span>
<span><span class="va">durees_sexe</span></span></code></pre></div>
<pre><code>  classe études temps plein temps partiel petits boulots inactivité
1  homme    5.5        27.7           0.4            1.2        0.9
2  femme    5.6        19.8           2.3            1.6        7.7
  serv. militaire
1             1.3
2             0.0</code></pre>
<p>On donne maintenant un exemple d’indicateur de complexité des
trajectoires, la turbulence, croisé avec l’année de naissance. On ne
constate pas d’évolution notable.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># turbulence</span></span>
<span><span class="va">turbu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqST.html" class="external-link">seqST</a></span><span class="op">(</span><span class="va">seqact</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">socdem</span><span class="op">$</span><span class="va">annais</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">turbu</span>, type<span class="op">=</span><span class="st">'l'</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">'Année de naissance'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-44-1.png" width="700"></p>
<p>D’autres indicateurs de complexité des trajectoires peuvent être
calculés facilement : indice de complexité (fonction
<code>seqici</code>), entropie individuelle (fonction
<code>seqient</code>), nombre de transitions (fonction
<code>seqtransn</code>).</p>
</div>
<div class="section level3">
<h3 id="analyse-de-variance">Analyse de variance<a class="anchor" aria-label="anchor" href="#analyse-de-variance"></a>
</h3>
<p>Avec une variable explicative unique, on mesure la part de la
variance des dissimilarités expliquée par la variable (à l’aide d’un
pseudo-R2), ainsi qu’une mesure de la variabilité des trajectoires pour
chacune des modalités de la variable, i.e. dans chaque sous-population.
Dans notre exemple, le sexe explique 7,4% de la variance des distances
entre trajectoires d’emploi (cf <em>pseudo R2</em> dans la rubrique
<em>Test values</em>), et la variabilité des trajectoires est nettement
plus élevée chez les femmes que chez les hommes (19,1 contre 9,4, cf
rubrique <em>Discrepancy per level</em>).</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># analyse de variance avec le sexe comme facteur</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/dissassoc.html" class="external-link">dissassoc</a></span><span class="op">(</span><span class="va">dissim</span>, <span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span></span></code></pre></div>
<pre><code>Pseudo ANOVA table:
             SS  df       MSE
Exp    591.0611   1 591.06114
Res   7347.0429 498  14.75310
Total 7938.1040 499  15.90802

Test values  (p-values based on 1000 permutation):
                     t0 p.value
Pseudo F    40.06352676   0.001
Pseudo Fbf  42.94304887   0.001
Pseudo R2    0.07445873   0.001
Bartlett    29.68308216   0.001
Levene     123.83930458   0.001

Inconclusive intervals: 
0.00383  &lt;  0.01  &lt;  0.0162
0.03649  &lt;  0.05  &lt;  0.0635 

Discrepancy per level:
        n discrepancy
homme 226    9.383918
femme 274   19.074005
Total 500   15.876208</code></pre>
<p>Il est possible de détailler ces indicateurs pour chaque position
dans le temps des trajectoires. Ainsi, la part de variance expliquée par
le sexe est presque nulle en début de trajectoire, elle croît ensuite
fortement entre 18 ans et environ 30 ans (elle est alors de 14%), puis
diminue pour n’être plus que de 5% à 50 ans.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># analyse de variance selon la position dans le temps</span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdiff.html" class="external-link">seqdiff</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">diff</span><span class="op">$</span><span class="va">stat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">diff</span><span class="op">$</span><span class="va">discrepancy</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">14</span><span class="op">:</span><span class="fl">49</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">diff</span>, stat<span class="op">=</span><span class="st">"Pseudo R2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-46-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>La variabilité des trajectoires des femmes et des hommes est faible
en début de trajectoire et augmente jusqu’à l’âge de 21 ans. Les
résultats divergent ensuite selon le sexe: la variabilité des
trajectoires féminines se maintient jusqu’à 50 ans, alors que celle des
hommes diminue fortement après 21 ans et atteint un niveau très faible
entre 30 et 50 ans.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">diff</span><span class="op">$</span><span class="va">discrepancy</span><span class="op">)</span>, <span class="st">"Set2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">diff</span>, stat<span class="op">=</span><span class="st">"discrepancy"</span>, legend.pos<span class="op">=</span><span class="cn">NA</span>, col<span class="op">=</span><span class="va">pal</span>, lwd<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, fill<span class="op">=</span><span class="va">pal</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">diff</span><span class="op">$</span><span class="va">discrepancy</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-47-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Avec plusieurs variables explicatives, on obtient la part de variance
expliquée par l’ensemble des variables et la décomposition de cette part
entre les variables. Ici, l’année de naissance, le sexe, le niveau de
diplôme et le nombre d’enfants expliquent ensemble 16,2% de la variance
des dissimilarités entre les trajectoires d’emploi: 7,7% pour le sexe,
6,0% pour le diplôme, 2,1% pour le nombre d’enfants et 0,3% pour l’année
de naissance.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># analyse de la variance avec facteurs multiples</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/dissmfacw.html" class="external-link">dissmfacw</a></span><span class="op">(</span><span class="va">dissim</span> <span class="op">~</span> <span class="va">annais</span><span class="op">+</span><span class="va">nbenf</span><span class="op">+</span><span class="va">sexe</span><span class="op">+</span><span class="va">diplome</span>, data<span class="op">=</span><span class="va">socdem</span><span class="op">)</span></span></code></pre></div>
<pre><code>  Variable   PseudoF    PseudoR2 p_value
1   annais  1.939020 0.003308502   0.042
2    nbenf  4.147849 0.021232117   0.001
3     sexe 45.251273 0.077211134   0.001
4  diplome 11.654366 0.059656674   0.001
5    Total 11.883983 0.162218781   0.001

Inconclusive intervals: 
0.00383  &lt;  0.01  &lt;  0.0162
0.03649  &lt;  0.05  &lt;  0.0635 </code></pre>
<p>Enfin, l’analyse de variance peut servir à construire un arbre de
décision, dit aussi arbre d’induction.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># arbre d'induction</span></span>
<span><span class="va">arbre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtree.html" class="external-link">seqtree</a></span><span class="op">(</span><span class="va">seqact</span> <span class="op">~</span> <span class="va">annais</span><span class="op">+</span><span class="va">nbenf</span><span class="op">+</span><span class="va">sexe</span><span class="op">+</span><span class="va">diplome</span>, data<span class="op">=</span><span class="va">socdem</span>, diss<span class="op">=</span><span class="va">dissim</span>, min.size<span class="op">=</span><span class="fl">0.1</span>, max.depth<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>L’arbre peut être présenté sous forme textuelle ou graphique. A
noter, la représentation graphique nécessite l’installation du logiciel
GraphViz (cf l’aide de la function <code>seqtreedisplay</code>).</p>
<p>Comme précédemment, on constate que la variable qui explique la plus
grande part de variance des dissimilarités est le sexe. Ensuite, pour
les femmes, la variable la plus discriminante est le nombre d’enfants
et, plus précisément, le fait d’avoir ou non trois enfants ou plus.
L’inactivité et, secondairement, le temps partiel sont plus présents
dans les trajectoires des femmes ayant au moins trois enfants que dans
celles des autres. Chez les hommes, en revanche, c’est le niveau de
diplôme qui est le plus discriminant (les hommes entrent plus tard sur
le marché du travail lorsqu’ils ont un diplôme supérieur ou égal au
baccalauréat).</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># résultats de l'arbre sous forme textuelle</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">arbre</span><span class="op">)</span></span></code></pre></div>
<pre><code>Dissimilarity tree:
 Parameters: min.size=50, max.depth=3, R=1000, pval=0.01 
 Formula: seqact ~ annais + nbenf + sexe + diplome 
 Global R2: 0.12934 

 Fitted tree: 

 |-- Root  (n: 500 disc: 15.876) 
   |-&gt; sexe 0.074459 
             |-- [ homme ]  (n: 226 disc: 9.3839) 
               |-&gt; diplome 0.093027 
                   |-- [ aucun,&lt;bac ]    (n: 131 disc: 8.5907)[(1,4)-(2,3)-(6,1)-(2,29)] * 
                   |-- [ bac,&gt;bac ]    (n: 95 disc: 8.401)[(1,9)-(2,28)] * 
             |-- [ femme ]  (n: 274 disc: 19.074) 
               |-&gt; nbenf 0.045614 
                   |-- [ trois ou + ]    (n: 86 disc: 21.168)[(1,4)-(2,10)-(5,13)-(2,10)] * 
                   |-- [ aucun,un,deux ]    (n: 188 disc: 16.848)[(1,6)-(2,31)] * </code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># résultats de l'arbre sous forme graphique</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtreedisplay.html" class="external-link">seqtreedisplay</a></span><span class="op">(</span><span class="va">arbre</span>,type<span class="op">=</span><span class="st">"d"</span>,border<span class="op">=</span><span class="cn">NA</span>,show.depth<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="http://nicolas.robette.free.fr/Docs/seqtree.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="statistiques-implicatives">Statistiques implicatives<a class="anchor" aria-label="anchor" href="#statistiques-implicatives"></a>
</h3>
<p>Pour étudier la manière dont les trajectoires diffèrent entre
plusieurs sous-populations, Studer propose d’utiliser les statistiques
implicatives. Il s’agit de reconstituer, pour chaque population, la
séquence des états typiques (Studer, 2012; Struffolino <em>et al</em>,
2016).</p>
<p>Ici, le service militaire est typique des trajectoires des hommes
autour de 20 ans, puis c’est l’emploi à temps plein à partir de 25 ans.
L’inactivité est caractéristique des trajectoires des femmes, et cela
dès l’âge de 18 ans. L’emploi à temps partiel l’est également, mais de
manière moins marquée et à partir de 30 ans.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># statistiques implicatives</span></span>
<span><span class="va">implic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineRextras/man/seqimplic.html" class="external-link">seqimplic</a></span><span class="op">(</span><span class="va">seqact</span>, group<span class="op">=</span><span class="va">socdem</span><span class="op">$</span><span class="va">sexe</span><span class="op">)</span></span>
<span><span class="co"># par(mar=c(2,2,2,2))</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">implic</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">50</span>, lwd<span class="op">=</span><span class="fl">2</span>, conf.level<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.99</span><span class="op">)</span>, cex.legend<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-53-1.png" width="80%" style="display: block; margin: auto;"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="analyse-de-séquences-multidimensionnelles">Analyse de séquences multidimensionnelles<a class="anchor" aria-label="anchor" href="#analyse-de-s%C3%A9quences-multidimensionnelles"></a>
</h2>
<div class="section level3">
<h3 id="mise-en-route-1">Mise en route<a class="anchor" aria-label="anchor" href="#mise-en-route-1"></a>
</h3>
<p>On commence par charger les données correspondant à trois dimensions
des trajectoires de 500 individus tirés au sort dans l’enquête
<em>Biographies et entourage</em> - matrimoniale, parentale et
résidentielle - et observées de 14 à 35 ans.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">seqmsa</span><span class="op">)</span></span>
<span><span class="va">trajmat</span> <span class="op">&lt;-</span> <span class="va">seqmsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'smat'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajmat</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  22 variables:
 $ smat14: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat15: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat16: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat17: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat18: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat19: num  1 1 1 1 1 1 1 1 1 1 ...
 $ smat20: num  1 3 1 1 3 1 1 1 1 1 ...
 $ smat21: num  1 3 1 1 3 3 1 3 1 1 ...
 $ smat22: num  1 3 1 3 3 3 1 3 1 1 ...
 $ smat23: num  1 3 1 3 3 3 1 3 1 1 ...
 $ smat24: num  1 3 1 3 3 3 1 3 1 1 ...
 $ smat25: num  1 3 3 3 3 3 1 3 2 1 ...
 $ smat26: num  2 3 3 3 3 3 1 3 2 1 ...
 $ smat27: num  2 3 3 3 3 3 1 3 2 1 ...
 $ smat28: num  2 3 3 3 3 3 1 3 3 1 ...
 $ smat29: num  2 3 3 3 3 3 1 3 3 1 ...
 $ smat30: num  2 3 3 3 3 3 1 3 3 1 ...
 $ smat31: num  3 3 3 3 3 3 1 3 3 1 ...
 $ smat32: num  3 3 3 3 2 3 1 3 3 1 ...
 $ smat33: num  3 3 3 3 2 3 3 3 3 1 ...
 $ smat34: num  3 3 3 3 2 3 3 3 3 1 ...
 $ smat35: num  3 3 3 3 2 3 3 3 3 1 ...</code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajenf</span> <span class="op">&lt;-</span> <span class="va">seqmsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'nenf'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajenf</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  22 variables:
 $ nenf14: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf15: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf16: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf17: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf18: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf19: num  0 0 0 0 0 0 0 0 0 0 ...
 $ nenf20: num  0 0 0 0 1 0 0 0 0 0 ...
 $ nenf21: num  0 1 0 0 1 0 0 0 0 0 ...
 $ nenf22: num  0 1 0 0 1 0 0 0 0 0 ...
 $ nenf23: num  0 1 0 0 1 0 0 0 0 0 ...
 $ nenf24: num  0 1 0 0 1 1 0 0 0 0 ...
 $ nenf25: num  0 1 0 1 1 1 0 1 0 0 ...
 $ nenf26: num  0 1 0 1 1 1 0 1 2 0 ...
 $ nenf27: num  0 1 0 1 1 1 0 1 2 0 ...
 $ nenf28: num  0 1 1 1 1 1 0 2 3 0 ...
 $ nenf29: num  0 2 1 2 1 1 0 2 3 0 ...
 $ nenf30: num  0 2 2 2 1 1 0 3 3 0 ...
 $ nenf31: num  1 2 2 2 1 1 0 3 3 0 ...
 $ nenf32: num  1 2 2 2 1 1 0 3 3 0 ...
 $ nenf33: num  1 2 2 2 2 1 0 3 3 0 ...
 $ nenf34: num  1 2 2 2 2 1 0 3 3 0 ...
 $ nenf35: num  1 2 2 2 2 1 0 3 3 0 ...</code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajlog</span> <span class="op">&lt;-</span> <span class="va">seqmsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'slog'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajlog</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   500 obs. of  22 variables:
 $ slog14: num  0 0 0 0 0 0 0 0 0 0 ...
 $ slog15: num  0 0 0 0 0 0 0 0 0 0 ...
 $ slog16: num  0 0 0 0 0 0 0 0 0 0 ...
 $ slog17: num  0 0 0 0 0 0 0 0 1 0 ...
 $ slog18: num  0 0 0 0 0 0 0 0 1 0 ...
 $ slog19: num  0 0 0 0 0 1 0 0 1 0 ...
 $ slog20: num  0 0 0 0 1 1 0 0 0 0 ...
 $ slog21: num  0 0 0 0 1 0 0 0 0 0 ...
 $ slog22: num  0 1 0 1 1 0 0 0 1 0 ...
 $ slog23: num  0 1 0 1 1 1 0 1 1 0 ...
 $ slog24: num  0 1 0 1 1 1 0 1 1 0 ...
 $ slog25: num  0 1 1 1 1 1 0 1 1 0 ...
 $ slog26: num  1 1 1 1 1 1 0 1 1 0 ...
 $ slog27: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog28: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog29: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog30: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog31: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog32: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog33: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog34: num  1 1 1 1 1 1 0 1 1 1 ...
 $ slog35: num  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>On définit ensuite trois objets séquences (un par dimension).</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># définition de la trajectoire matrimoniale</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jamais"</span>,<span class="st">"union libre"</span>,<span class="st">"marié"</span>,<span class="st">"separé"</span><span class="op">)</span></span>
<span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">labs</span><span class="op">)</span>, <span class="st">'Set2'</span><span class="op">)</span></span>
<span><span class="va">seqmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajmat</span>, labels<span class="op">=</span><span class="va">labs</span>, cpal<span class="op">=</span><span class="va">palette</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># définition de la trajectoire parentale</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>,<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3+"</span><span class="op">)</span></span>
<span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">labs</span><span class="op">)</span>, <span class="st">'YlOrRd'</span><span class="op">)</span></span>
<span><span class="va">seqenf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajenf</span>, labels<span class="op">=</span><span class="va">labs</span>, cpal<span class="op">=</span><span class="va">palette</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># définition de la trajectoire d'indépendance résidentielle</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"non indépendant"</span>,<span class="st">"indépendant"</span><span class="op">)</span></span>
<span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'Set1'</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">seqlog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajlog</span>, labels<span class="op">=</span><span class="va">labs</span>, cpal<span class="op">=</span><span class="va">palette</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="association-entre-dimensions">Association entre dimensions<a class="anchor" aria-label="anchor" href="#association-entre-dimensions"></a>
</h3>
<p>On calcule la matrice de distance de chacune des dimensions, en
utisant l’Optimal Matching (coût de substitution unique et égal à 2,
coût <em>indel</em> de 1,5).</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># matrices de distances des différentes dimensions</span></span>
<span><span class="va">dmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqmat</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqmat</span>,<span class="st">"CONSTANT"</span>,cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">denf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqenf</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqenf</span>,<span class="st">"CONSTANT"</span>,cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dlog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqlog</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqlog</span>,<span class="st">"CONSTANT"</span>,cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>On calcule également une matrice de distance à partir d’une analyse
de séquences multiples (dite aussi “multichannel sequence analysis”). On
décide ici de garder les mêmes coûts pour chacune des dimensions, mais
ce n’est pas obligatoire.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># matrice de distances entre séquences multidimensionnelles</span></span>
<span><span class="va">dissim.MSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqMD.html" class="external-link">seqdistmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seqmat</span>,<span class="va">seqenf</span>,<span class="va">seqlog</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CONSTANT"</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>On étudie ensuite dans quelle mesure les différentes dimensions sont
liées, ce qui peut être réalisé de plusieurs manières (Piccarreta,
2017). D’après les corrélations, on voit que la dimension logement
(“log”) est la moins liée à la matrice de distance entre séquences
multiples (appelée ici “jsa” pour Joint Sequence Analysis). Elle est de
plus très peu associée à la dimension parentale (“enf”). Les dimensions
matrimoniale (“mat”) et parentales sont les plus liées. L’examen des
alpha de Cronbach confirme ces résultats.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assoc.domains.html">assoc.domains</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dmat</span>,<span class="va">denf</span>,<span class="va">dlog</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'mat'</span>,<span class="st">'enf'</span>,<span class="st">'log'</span><span class="op">)</span>, <span class="va">dissim.MSA</span><span class="op">)</span></span>
<span><span class="va">asso</span></span></code></pre></div>
<pre><code>$correlations
$correlations$pearson
      mat   enf   log   jsa
mat 1.000 0.372 0.275 0.797
enf 0.372 1.000 0.090 0.702
log 0.275 0.090 1.000 0.604
jsa 0.797 0.702 0.604 1.000

$correlations$spearman
      mat   enf   log   jsa
mat 1.000 0.370 0.280 0.794
enf 0.370 1.000 0.096 0.705
log 0.280 0.096 1.000 0.565
jsa 0.794 0.705 0.565 1.000


$`mean squared correlations`
$`mean squared correlations`$pearson
[1] 0.498

$`mean squared correlations`$spearman
[1] 0.483


$`Cronbach's alpha`
$`Cronbach's alpha`$`(mat,enf,log)`
[1] 0.494

$`Cronbach's alpha`$`(mat,enf)`
[1] 0.542

$`Cronbach's alpha`$`(mat,log)`
[1] 0.431

$`Cronbach's alpha`$`(enf,log)`
[1] 0.166</code></pre>
<p>On peut encore se faire une idée de la structure des associations
entre dimensions en réalisant une analyse en composantes principales
(ACP) de la matrice de corrélation entre dimensions.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ACP à partir des corrélations entre dimensions</span></span>
<span><span class="va">matcor</span> <span class="op">&lt;-</span> <span class="va">asso</span><span class="op">$</span><span class="va">correlations</span><span class="op">$</span><span class="va">pearson</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">PCA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html" class="external-link">PCA</a></span><span class="op">(</span><span class="va">matcor</span>, scale.unit<span class="op">=</span><span class="cn">F</span>, graph<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/plot.PCA.html" class="external-link">plot.PCA</a></span><span class="op">(</span><span class="va">PCA</span>, choix<span class="op">=</span><span class="st">'varcor'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-63-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>On calcule ensuite plusieurs matrices de distance entre séquences
multiples en excluant à chaque l’une des dimensions.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dnolog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqMD.html" class="external-link">seqdistmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seqmat</span>,<span class="va">seqenf</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CONSTANT"</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dnomat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqMD.html" class="external-link">seqdistmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seqenf</span>,<span class="va">seqlog</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CONSTANT"</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dnoenf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqMD.html" class="external-link">seqdistmc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seqmat</span>,<span class="va">seqlog</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"OM"</span>, indel<span class="op">=</span><span class="fl">1.5</span>, sm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CONSTANT"</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dnolog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dnolog</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dnomat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dnomat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dnoenf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dnoenf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>On examine ensuite, pour chaque dimension, la corrélation entre sa
matrice de distance et la matrice de distance entre séquences multiples
excluant cette dimension. Une fois encore, on voit que c’est la
dimension logement qui est la moins associée aux autres.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dmat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.numeric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dnomat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.418</code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">denf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.numeric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dnoenf</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.304</code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlog</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as.numeric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dnolog</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.216</code></pre>
<p>Une dernière option consiste à trier les <em>index plots</em> de
toutes les dimensions selon les résultats d’un <em>multidimensional
scaling</em> (MDS) réalisé pour une seule dimension (Piccarreta &amp;
Lior, 2010). Ici, on trie les séquences à partir d’un MDS de la
dimension matrimoniale. L’ordre des séquences des deux autres dimensions
semble obéir à une logique interprétable, on peut donc considérer que
les dimensions sont suffisamment liées entre elles pour justifier une
analyse de séquences multiples.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mds.msa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dmat</span>,k<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.1</span>,<span class="fl">2.1</span>,<span class="fl">2.1</span>,<span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqmat</span>, sortv<span class="op">=</span><span class="va">mds.msa</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqmat</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqenf</span>, sortv<span class="op">=</span><span class="va">mds.msa</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqenf</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqIplot</a></span><span class="op">(</span><span class="va">seqlog</span>, sortv<span class="op">=</span><span class="va">mds.msa</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, yaxis<span class="op">=</span><span class="cn">FALSE</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqlog</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-66-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="typologie-de-séquences-via-multidimensional-sequence-analysis-msa">Typologie de séquences via <em>Multidimensional Sequence
Analysis</em> (MSA)<a class="anchor" aria-label="anchor" href="#typologie-de-s%C3%A9quences-via-multidimensional-sequence-analysis-msa"></a>
</h3>
<p>Pour obtenir une typologie, on réalise une CAH à partir de la matrice
de distance issue de l’analyse de séquences multiples.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># classification ascendante hiérarchique</span></span>
<span><span class="va">agnes.MSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissim.MSA</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"ward"</span>, keep.diss<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">agnes.MSA</span><span class="op">)</span>, leaflab<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-67-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>On opte pour une typologie en 5 classes.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choix d'une typologie en 5 classes</span></span>
<span><span class="va">nbcl.MSA</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">part.MSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">agnes.MSA</span>, <span class="va">nbcl.MSA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">factor</span></span></code></pre></div>
<p>Pour obtenir les chronogrammes des classes de la typologie (un
graphique par classe et par dimension) :</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># chronogrammes de la typologie</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">nbcl.MSA</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.MSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqmat</span><span class="op">[</span><span class="va">part.MSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'classe'</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqmat</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.MSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqenf</span><span class="op">[</span><span class="va">part.MSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqenf</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.MSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqlog</span><span class="op">[</span><span class="va">part.MSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">35</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqlog</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="typologie-de-séquences-via-globally-interdependent-multiple-sequence-analysis-gimsa">Typologie de séquences via <em>Globally Interdependent Multiple
Sequence Analysis</em> (GIMSA)<a class="anchor" aria-label="anchor" href="#typologie-de-s%C3%A9quences-via-globally-interdependent-multiple-sequence-analysis-gimsa"></a>
</h3>
<p>Une alternative à l’analyse de séquences multiples est la
<em>Globally Interdependent Multiple Sequence Analysis</em> (GIMSA, voir
Robette <em>et al</em>, 2015).</p>
<p>On commence par charger les données et les coder sous forme de
séquences. Il s’agit de : - 400 trajectoires professionnelles de mères,
observées entre 14 et 60 ans avec les états suivants: indépendante,
catégorie socioprofessionnelle moyenne/supérieure, catégorie
socioprofessionnelle populaire, inactivité, études. - 400 trajectoires
d’emploi de leurs filles, observées au cours des 15 premières années
après la fin des études, avec les états suivants: études, inactivité,
temps partiel , temps plein.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># chargement des données</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">seqgimsa</span><span class="op">)</span></span>
<span><span class="va">trajfilles</span> <span class="op">&lt;-</span> <span class="va">seqgimsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'f'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajfilles</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   400 obs. of  15 variables:
 $ f1 : num  4 4 4 4 3 4 4 4 4 4 ...
 $ f2 : num  4 4 4 4 4 4 4 4 4 4 ...
 $ f3 : num  4 4 4 4 4 4 4 4 4 2 ...
 $ f4 : num  4 4 4 4 4 4 4 4 4 2 ...
 $ f5 : num  4 4 4 4 4 4 4 2 4 2 ...
 $ f6 : num  4 4 4 4 4 4 4 2 4 2 ...
 $ f7 : num  4 4 4 4 4 4 4 2 4 2 ...
 $ f8 : num  4 4 4 2 4 4 4 2 4 2 ...
 $ f9 : num  4 4 4 4 4 4 4 2 4 2 ...
 $ f10: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f11: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f12: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f13: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f14: num  4 4 4 4 4 4 4 2 4 2 ...
 $ f15: num  4 4 4 4 4 4 4 2 4 2 ...</code></pre>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajmeres</span> <span class="op">&lt;-</span> <span class="va">seqgimsa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'m'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">trajmeres</span><span class="op">)</span></span></code></pre></div>
<pre><code>'data.frame':   400 obs. of  47 variables:
 $ m14: num  5 5 9 9 8 8 9 9 9 9 ...
 $ m15: num  5 5 9 9 8 8 9 9 9 9 ...
 $ m16: num  5 5 9 9 8 8 9 9 9 9 ...
 $ m17: num  5 5 9 9 8 8 9 9 9 9 ...
 $ m18: num  5 5 9 3 8 8 9 9 3 5 ...
 $ m19: num  5 5 9 3 8 8 9 9 3 5 ...
 $ m20: num  5 5 9 3 8 8 9 9 3 5 ...
 $ m21: num  5 5 9 3 8 8 9 5 3 5 ...
 $ m22: num  5 5 9 3 8 8 9 5 3 5 ...
 $ m23: num  5 5 9 3 8 8 9 5 3 5 ...
 $ m24: num  5 5 9 3 8 8 9 5 3 8 ...
 $ m25: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m26: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m27: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m28: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m29: num  5 5 9 3 8 8 1 5 3 8 ...
 $ m30: num  5 5 9 8 8 8 1 5 3 8 ...
 $ m31: num  5 5 9 8 8 8 1 5 3 8 ...
 $ m32: num  5 5 9 8 8 8 1 5 3 8 ...
 $ m33: num  5 5 9 8 8 8 1 5 3 8 ...
 $ m34: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m35: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m36: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m37: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m38: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m39: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m40: num  5 5 8 8 8 8 1 5 3 8 ...
 $ m41: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m42: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m43: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m44: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m45: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m46: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m47: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m48: num  5 5 5 8 8 8 1 5 3 8 ...
 $ m49: num  8 5 5 9 8 8 1 5 3 8 ...
 $ m50: num  8 5 5 9 8 8 1 5 3 8 ...
 $ m51: num  8 5 5 9 8 8 1 5 3 8 ...
 $ m52: num  8 5 5 9 8 8 1 5 3 8 ...
 $ m53: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m54: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m55: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m56: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m57: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m58: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m59: num  8 5 5 9 8 8 1 5 8 8 ...
 $ m60: num  8 8 5 9 8 8 1 8 8 8 ...</code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># définition des séquences</span></span>
<span><span class="va">lab.meres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"indép"</span>,<span class="st">"moyen/sup"</span>,<span class="st">"popu"</span>,<span class="st">"inactivité"</span>,<span class="st">"études"</span><span class="op">)</span></span>
<span><span class="va">pal.meres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Set1"</span><span class="op">)</span></span>
<span><span class="va">seqmeres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajmeres</span>,lab<span class="op">=</span><span class="va">lab.meres</span>, cpal<span class="op">=</span><span class="va">pal.meres</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lab.filles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"études"</span>,<span class="st">"inactivité"</span>,<span class="st">"temps partiel"</span>,<span class="st">"temps plein"</span><span class="op">)</span></span>
<span><span class="va">pal.meres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"Set1"</span><span class="op">)</span></span>
<span><span class="va">seqfilles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">trajfilles</span>,lab<span class="op">=</span><span class="va">lab.filles</span>, cpla<span class="op">=</span><span class="va">pal.filles</span><span class="op">)</span></span></code></pre></div>
<p>La première étape consiste à calculer une matrice de distance pour
les mères et une pour les filles. On utilise la métrique LCS pour les
mères et la distance de Hamming pour les filles.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># étape 1 : mesure de dissimilarité</span></span>
<span><span class="va">dmeres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqmeres</span>,method<span class="op">=</span><span class="st">"LCS"</span><span class="op">)</span></span>
<span><span class="va">cout.filles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqcost.html" class="external-link">seqsubm</a></span><span class="op">(</span><span class="va">seqfilles</span>, method<span class="op">=</span><span class="st">"CONSTANT"</span>, cval<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dfilles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">seqfilles</span>, method<span class="op">=</span><span class="st">"HAM"</span>, sm<span class="op">=</span><span class="va">cout.filles</span><span class="op">)</span></span></code></pre></div>
<p>Dans la seconde étape, on résume les matrices de distance à partir
d’un MDS.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># étape 2 : multidimensional scaling</span></span>
<span><span class="va">mds.meres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dmeres</span>, k<span class="op">=</span><span class="fl">20</span>, eig<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mds.filles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dfilles</span>, k<span class="op">=</span><span class="fl">20</span>, eig<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>On sélectionne le nombre de facteurs à retenir pour chacun des
MDS.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choix du nombre de dimensions à retenir pour les mères</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># mesure de stress</span></span>
<span><span class="fu"><a href="../reference/seqmds.stress.html">seqmds.stress</a></span><span class="op">(</span><span class="va">dmeres</span>, <span class="va">mds.meres</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'l'</span>, xlab<span class="op">=</span><span class="st">'nombre de facteurs'</span>, ylab<span class="op">=</span><span class="st">'stress'</span><span class="op">)</span></span>
<span><span class="co"># part de variance expliquée</span></span>
<span><span class="op">(</span><span class="va">mds.meres</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">/</span><span class="va">mds.meres</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'s'</span>, xlab<span class="op">=</span><span class="st">'nombre de facteurs'</span>, ylab<span class="op">=</span><span class="st">'part de variance expliquée'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-76-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choix du nombre de dimensions à retenir pour les filles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># mesure de stress</span></span>
<span><span class="fu"><a href="../reference/seqmds.stress.html">seqmds.stress</a></span><span class="op">(</span><span class="va">dfilles</span>, <span class="va">mds.filles</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'l'</span>, xlab<span class="op">=</span><span class="st">'nombre de facteurs'</span>, ylab<span class="op">=</span><span class="st">'stress'</span><span class="op">)</span></span>
<span><span class="co"># part de variance expliquée</span></span>
<span><span class="op">(</span><span class="va">mds.filles</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">/</span><span class="va">mds.filles</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'s'</span>, xlab<span class="op">=</span><span class="st">'nombre de facteurs'</span>, ylab<span class="op">=</span><span class="st">'part de variance expliquée'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-77-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Dans la troisième étape, on résume les relations entre les résultats
du MDS des mères et ceux du MDS des filles, à l’aide d’une PLS
symétrique.</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># étape 3 : PLS symétrique</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">mds.meres</span><span class="op">$</span><span class="va">points</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">mds.filles</span><span class="op">$</span><span class="va">points</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">pls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/symPLS.html">symPLS</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span></span></code></pre></div>
<p>Dans la quatrième et dernière étape, on calcule une matrice de
distance unique entre les dyades de trajectoires mères-filles. Il est
possible de pondérer les dimensions des mères et des filles, pour
équilibrer leur contribution aux résultats finaux.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># étape 4 : distance et classification</span></span>
<span></span>
<span><span class="co"># pas de pondération</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="cn">F</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="va">G</span></span>
<span></span>
<span><span class="co"># pondération par la variance des composantes de la PLS (w1)</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="cn">F</span>,<span class="fl">2</span>,<span class="va">scale</span>,center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="va">G</span>,<span class="fl">2</span>,<span class="va">scale</span>,center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># pondération par le nombre de séquences distinctes (w2)</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="cn">F</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtab.html" class="external-link">seqtab</a></span><span class="op">(</span><span class="va">seqmeres</span>,tlim<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="va">G</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqtab.html" class="external-link">seqtab</a></span><span class="op">(</span><span class="va">seqfilles</span>,tlim<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># pondération par la 1ère valeur propre du MDS (w3)</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="cn">F</span><span class="op">/</span><span class="va">mds.meres</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">pls</span><span class="op">$</span><span class="va">G</span><span class="op">/</span><span class="va">mds.filles</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>On utilise ici la pondération w1.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pondération par la variance des composantes de la PLS (w1)</span></span>
<span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="cn">F</span>,<span class="fl">2</span>,<span class="va">scale</span>,center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pls</span><span class="op">$</span><span class="va">G</span>,<span class="fl">2</span>,<span class="va">scale</span>,center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calcul de distance</span></span>
<span><span class="va">diff2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">X</span>,upper<span class="op">=</span><span class="cn">T</span>,diag<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">diff2</span><span class="op">(</span><span class="cn">F</span><span class="op">)</span><span class="op">+</span><span class="fu">diff2</span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span></span></code></pre></div>
<p>On réalise ensuite une classification automatique (ici une CAH).</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># classification</span></span>
<span><span class="va">dist.GIMSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="va">agnes.GIMSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></span><span class="op">(</span><span class="va">dist.GIMSA</span>, method<span class="op">=</span><span class="st">"ward"</span>, keep.diss<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">agnes.GIMSA</span><span class="op">)</span>, leaflab<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-82-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>On choisit une partition en 5 classes.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># partition en 5 classes</span></span>
<span><span class="va">nbcl.GIMSA</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">part.GIMSA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">agnes.GIMSA</span>, <span class="va">nbcl.GIMSA</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">factor</span></span></code></pre></div>
<p>Pour finir, on représente graphiquement la typologie à l’aide de
chronogrammes.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">nbcl.GIMSA</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.GIMSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqmeres</span><span class="op">[</span><span class="va">part.GIMSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">14</span><span class="op">:</span><span class="fl">60</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'classe'</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nbcl.GIMSA</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">seqdplot</a></span><span class="op">(</span><span class="va">seqfilles</span><span class="op">[</span><span class="va">part.GIMSA</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>, xtlab<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, border<span class="op">=</span><span class="cn">NA</span>, with.legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqmeres</span>, cex<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqlegend.html" class="external-link">seqlegend</a></span><span class="op">(</span><span class="va">seqfilles</span>, cex<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutoriel_files/figure-html/unnamed-chunk-84-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://github.com/nicolas-robette" class="external-link">Nicolas Robette</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
